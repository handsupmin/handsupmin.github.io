<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Vitest 완벽 가이드 | HandsLog</title>
<meta name=keywords content="vitest,vite,jest-compatibility,testing,unit-testing,typescript,mocking,spying,node,cli"><meta name=description content="개요
Vite 기반의 테스트 프레임워크 Vitest 소개 및 실무 사용 패턴 정리
Jest와 거의 동일한 API를 제공하고, Vite의 ESM/HMR을 활용해 빠른 재실행을 제공함
Vite 프로젝트에서는 최소 설정으로 바로 사용 가능

빠른 실행과 재실행, watch 효율 높음
Jest API 호환성 높아 러닝 커브 낮음
TypeScript 네이티브 지원


1. 기본 구조
테스트 파일 명명 규칙
*.spec.ts     또는     *.test.tsdescribe(name, fn)
관련 테스트를 그룹화하는 컨테이너
import { describe, it, expect } from 'vitest'

describe('계산기', () => {
  it('두 수를 더한다', () => {
    expect(1 + 2).toBe(3)
  })

  it('두 수를 뺀다', () => {
    expect(5 - 3).toBe(2)
  })
})
첫 번째 인자: 그룹 이름
두 번째 인자: 테스트 콜백
중첩 describe 구성 가능

it(name, fn) / test(name, fn)
개별 테스트 케이스 정의, 두 API는 동일 동작"><meta name=author content><link rel=canonical href=https://blog.jsontapose.com/posts/vitest-complete-guide-3d3f4f/><link crossorigin=anonymous href=/assets/css/stylesheet.08f7d74f0ada0f975d29ae436285b61ed7a719d05f350cb888d00341642995a2.css integrity="sha256-CPfXTwraD5ddKa5DYoW2HtenGdBfNQy4iNADQWQplaI=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.jsontapose.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.jsontapose.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.jsontapose.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.jsontapose.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.jsontapose.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/json href=https://blog.jsontapose.com/posts/vitest-complete-guide-3d3f4f/index.json><link rel=alternate hreflang=en href=https://blog.jsontapose.com/posts/vitest-complete-guide-3d3f4f/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=module>
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

  const isDark = () =>
    document.body.classList.contains("dark") ||
    window.matchMedia?.("(prefers-color-scheme: dark)")?.matches;

  const getThemeOptions = () => {
    const dark = isDark();
    return {
      startOnLoad: false,
      securityLevel: "loose", 
      theme: dark ? "dark" : "default",
      themeVariables: dark
        ? {
            primaryColor: "#0f172a"  ,
            primaryTextColor: "#e5e7eb"  ,
            primaryBorderColor: "#94a3b8"  ,
            lineColor: "#94a3b8",
            textColor: "#e5e7eb",
            nodeTextColor: "#e5e7eb",
            edgeLabelBackground: "#0f172a",
          }
        : {
            primaryColor: "#f8fafc"  ,
            primaryTextColor: "#111827",
            primaryBorderColor: "#374151",
            lineColor: "#374151",
            textColor: "#111827",
            nodeTextColor: "#111827",
            edgeLabelBackground: "#ffffff",
          },
    };
  };

  const renderMermaid = () => {
    
    document.querySelectorAll(".mermaid[data-processed]").forEach((el) => {
      el.removeAttribute("data-processed");
    });
    mermaid.initialize(getThemeOptions());
    mermaid.run({ querySelector: ".mermaid" });
  };

  
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", renderMermaid, {
      once: true,
    });
  } else {
    renderMermaid();
  }

  
  const btn = document.getElementById("theme-toggle");
  if (btn) {
    btn.addEventListener("click", () => {
      
      setTimeout(renderMermaid, 0);
    });
  }

  
  const mql = window.matchMedia?.("(prefers-color-scheme: dark)");
  if (mql && mql.addEventListener) {
    mql.addEventListener("change", renderMermaid);
  }
</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NKJRT1NC1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6NKJRT1NC1")</script><meta name=google-adsense-account content="ca-pub-6022353980017733"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6022353980017733" crossorigin=anonymous></script><meta property="og:url" content="https://blog.jsontapose.com/posts/vitest-complete-guide-3d3f4f/"><meta property="og:site_name" content="HandsLog"><meta property="og:title" content="Vitest 완벽 가이드"><meta property="og:description" content="개요 Vite 기반의 테스트 프레임워크 Vitest 소개 및 실무 사용 패턴 정리 Jest와 거의 동일한 API를 제공하고, Vite의 ESM/HMR을 활용해 빠른 재실행을 제공함 Vite 프로젝트에서는 최소 설정으로 바로 사용 가능
빠른 실행과 재실행, watch 효율 높음 Jest API 호환성 높아 러닝 커브 낮음 TypeScript 네이티브 지원 1. 기본 구조 테스트 파일 명명 규칙 *.spec.ts 또는 *.test.tsdescribe(name, fn) 관련 테스트를 그룹화하는 컨테이너
import { describe, it, expect } from 'vitest' describe('계산기', () => { it('두 수를 더한다', () => { expect(1 + 2).toBe(3) }) it('두 수를 뺀다', () => { expect(5 - 3).toBe(2) }) }) 첫 번째 인자: 그룹 이름 두 번째 인자: 테스트 콜백 중첩 describe 구성 가능 it(name, fn) / test(name, fn) 개별 테스트 케이스 정의, 두 API는 동일 동작"><meta property="og:locale" content="ko-kr"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-01T13:16:32+00:00"><meta property="article:modified_time" content="2026-02-01T13:16:32+00:00"><meta property="article:tag" content="Vitest"><meta property="article:tag" content="Vite"><meta property="article:tag" content="Jest-Compatibility"><meta property="article:tag" content="Testing"><meta property="article:tag" content="Unit-Testing"><meta property="article:tag" content="Typescript"><meta name=twitter:card content="summary"><meta name=twitter:title content="Vitest 완벽 가이드"><meta name=twitter:description content="개요
Vite 기반의 테스트 프레임워크 Vitest 소개 및 실무 사용 패턴 정리
Jest와 거의 동일한 API를 제공하고, Vite의 ESM/HMR을 활용해 빠른 재실행을 제공함
Vite 프로젝트에서는 최소 설정으로 바로 사용 가능

빠른 실행과 재실행, watch 효율 높음
Jest API 호환성 높아 러닝 커브 낮음
TypeScript 네이티브 지원


1. 기본 구조
테스트 파일 명명 규칙
*.spec.ts     또는     *.test.tsdescribe(name, fn)
관련 테스트를 그룹화하는 컨테이너
import { describe, it, expect } from 'vitest'

describe('계산기', () => {
  it('두 수를 더한다', () => {
    expect(1 + 2).toBe(3)
  })

  it('두 수를 뺀다', () => {
    expect(5 - 3).toBe(2)
  })
})
첫 번째 인자: 그룹 이름
두 번째 인자: 테스트 콜백
중첩 describe 구성 가능

it(name, fn) / test(name, fn)
개별 테스트 케이스 정의, 두 API는 동일 동작"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.jsontapose.com/posts/"},{"@type":"ListItem","position":2,"name":"Vitest 완벽 가이드","item":"https://blog.jsontapose.com/posts/vitest-complete-guide-3d3f4f/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Vitest 완벽 가이드","name":"Vitest 완벽 가이드","description":"개요 Vite 기반의 테스트 프레임워크 Vitest 소개 및 실무 사용 패턴 정리 Jest와 거의 동일한 API를 제공하고, Vite의 ESM/HMR을 활용해 빠른 재실행을 제공함 Vite 프로젝트에서는 최소 설정으로 바로 사용 가능\n빠른 실행과 재실행, watch 효율 높음 Jest API 호환성 높아 러닝 커브 낮음 TypeScript 네이티브 지원 1. 기본 구조 테스트 파일 명명 규칙 *.spec.ts 또는 *.test.tsdescribe(name, fn) 관련 테스트를 그룹화하는 컨테이너\nimport { describe, it, expect } from \u0026#39;vitest\u0026#39; describe(\u0026#39;계산기\u0026#39;, () =\u0026gt; { it(\u0026#39;두 수를 더한다\u0026#39;, () =\u0026gt; { expect(1 + 2).toBe(3) }) it(\u0026#39;두 수를 뺀다\u0026#39;, () =\u0026gt; { expect(5 - 3).toBe(2) }) }) 첫 번째 인자: 그룹 이름 두 번째 인자: 테스트 콜백 중첩 describe 구성 가능 it(name, fn) / test(name, fn) 개별 테스트 케이스 정의, 두 API는 동일 동작\n","keywords":["vitest","vite","jest-compatibility","testing","unit-testing","typescript","mocking","spying","node","cli"],"articleBody":"개요 Vite 기반의 테스트 프레임워크 Vitest 소개 및 실무 사용 패턴 정리 Jest와 거의 동일한 API를 제공하고, Vite의 ESM/HMR을 활용해 빠른 재실행을 제공함 Vite 프로젝트에서는 최소 설정으로 바로 사용 가능\n빠른 실행과 재실행, watch 효율 높음 Jest API 호환성 높아 러닝 커브 낮음 TypeScript 네이티브 지원 1. 기본 구조 테스트 파일 명명 규칙 *.spec.ts 또는 *.test.tsdescribe(name, fn) 관련 테스트를 그룹화하는 컨테이너\nimport { describe, it, expect } from 'vitest' describe('계산기', () =\u003e { it('두 수를 더한다', () =\u003e { expect(1 + 2).toBe(3) }) it('두 수를 뺀다', () =\u003e { expect(5 - 3).toBe(2) }) }) 첫 번째 인자: 그룹 이름 두 번째 인자: 테스트 콜백 중첩 describe 구성 가능 it(name, fn) / test(name, fn) 개별 테스트 케이스 정의, 두 API는 동일 동작\nit('유효한 이메일이면 true를 반환', () =\u003e { expect(isValidEmail('test@example.com')).toBe(true) }) test('유효한 이메일이면 true를 반환', () =\u003e { expect(isValidEmail('test@example.com')).toBe(true) })중첩 describe 출력 예 describe('UserService', () =\u003e { describe('create', () =\u003e { it('유효한 데이터로 유저 생성', () =\u003e { /* ... */ }) it('중복 이메일이면 에러', () =\u003e { /* ... */ }) }) describe('delete', () =\u003e { it('존재하는 유저 삭제', () =\u003e { /* ... */ }) }) })UserService create ✓ 유효한 데이터로 유저 생성 ✓ 중복 이메일이면 에러 delete ✓ 존재하는 유저 삭제 2. expect와 매처 expect(value) 검증 시작점, 다양한 매처 체이닝 지원\nexpect(실제값).matcher(기대값)기본 비교 매처 toBe(expected) 엄격 동등 비교 ===, 원시값 비교에 사용\nexpect(1 + 2).toBe(3) expect('hello').toBe('hello') expect(true).toBe(true) // 객체/배열은 참조 비교라 실패 expect({ a: 1 }).toBe({ a: 1 }) // 실패 toEqual(expected) 깊은 동등 비교, 객체/배열 내용 비교\nexpect({ name: 'John', age: 30 }).toEqual({ name: 'John', age: 30 }) expect([1, 2, 3]).toEqual([1, 2, 3]) expect({ user: { name: 'John' }, items: [1, 2] }).toEqual({ user: { name: 'John' }, items: [1, 2] })toStrictEqual(expected) toEqual보다 엄격, undefined 속성·희소 배열·클래스 인스턴스까지 체크\nexpect({ a: 1, b: undefined }).toEqual({ a: 1 }) expect({ a: 1, b: undefined }).toStrictEqual({ a: 1 }) // 실패 class User { name = 'John' } expect(new User()).toEqual({ name: 'John' }) expect(new User()).toStrictEqual({ name: 'John' }) // 실패 Truthiness 매처 toBeTruthy / toBeFalsy JavaScript truthy/falsy 규칙 기반 검증\n// Truthy: 0, '', null, undefined, NaN, false 외의 모든 값 expect(1).toBeTruthy() expect('hello').toBeTruthy() expect([]).toBeTruthy() expect({}).toBeTruthy() // Falsy: 0, '', null, undefined, NaN, false expect(0).toBeFalsy() expect('').toBeFalsy() expect(null).toBeFalsy()toBeNull / toBeUndefined / toBeDefined 명확한 의도 표현에 유용\nexpect(null).toBeNull() expect(undefined).toBeUndefined() expect('value').toBeDefined()숫자 비교 매처 toBeGreaterThan / toBeLessThan / toBeGreaterThanOrEqual / toBeLessThanOrEqual expect(10).toBeGreaterThan(5) expect(10).toBeGreaterThanOrEqual(10) expect(3).toBeLessThan(5) expect(3).toBeLessThanOrEqual(3)toBeCloseTo(n, precision?) 부동소수점 오차 허용 비교, precision 기본값 2\nexpect(0.1 + 0.2).toBeCloseTo(0.3) expect(0.1 + 0.2).toBeCloseTo(0.3, 5)문자열 매처 toMatch(regexp | string) 정규식 또는 부분 문자열 매칭\nexpect('hello world').toMatch(/world/) expect('hello world').toMatch('world') expect('hello world').toMatch(/^hello/) expect('Error: 404').toMatch(/Error: \\d+/)toContain(item) 문자열에 부분 문자열 포함 여부\nexpect('hello world').toContain('world')배열/이터러블 매처 toContain(item) 배열에 특정 요소 포함 여부\nexpect([1, 2, 3]).toContain(2) const obj = { id: 1 } expect([obj]).toContain(obj) expect([{ id: 1 }]).toContain({ id: 1 }) // 실패: 참조 다름 toContainEqual(item) 배열 내 객체를 깊게 비교\nexpect([{ id: 1 }, { id: 2 }]).toContainEqual({ id: 1 })toHaveLength(n) 배열·문자열의 길이 검증\nexpect([1, 2, 3]).toHaveLength(3) expect('hello').toHaveLength(5) expect({ length: 3 }).toHaveLength(3)예외 검증 매처 toThrow(error?) 함수가 에러를 던지는지 검증, 함수 참조를 전달해야 함\nexpect(() =\u003e { throw new Error('fail') }).toThrow() expect(() =\u003e { throw new Error('Invalid email') }).toThrow('Invalid email') expect(() =\u003e { throw new Error('User 123 not found') }).toThrow(/not found/) class ValidationError extends Error {} expect(() =\u003e { throw new ValidationError('invalid') }).toThrow(ValidationError)잘못된 사용 예\n// 즉시 실행되어 실패 expect(throwingFn()).toThrow() // 올바른 사용 expect(() =\u003e throwingFn()).toThrow()rejects.toThrow 비동기 에러 async function asyncFail() { throw new Error('async error') } await expect(asyncFail()).rejects.toThrow('async error') await expect(Promise.reject(new Error('fail'))).rejects.toThrow()부정 not 모든 매처 앞에서 반대 조건 검증\nexpect(5).not.toBe(3) expect([1, 2]).not.toContain(5) expect(null).not.toBeDefined() expect(() =\u003e safeFn()).not.toThrow() 3. Setup과 Teardown beforeAll(fn) 모든 테스트 전 1회 실행, DB 연결·서버 시작 등 공용 리소스 준비\nimport { beforeAll } from 'vitest' let db: Database beforeAll(async () =\u003e { db = await Database.connect() })afterAll(fn) 모든 테스트 후 1회 실행, 리소스 정리\nimport { afterAll } from 'vitest' afterAll(async () =\u003e { await db.disconnect() })beforeEach(fn) 각 테스트 전 매번 실행, 상태 격리\nimport { beforeEach, vi } from 'vitest' beforeEach(() =\u003e { vi.clearAllMocks() })afterEach(fn) 각 테스트 후 매번 실행, 정리 작업\nimport { afterEach } from 'vitest' afterEach(() =\u003e { cleanup() })실행 순서 예시\nbeforeAll ← 1번 ├── beforeEach ← 매번 │ └── 테스트 1 │ └── afterEach ← 매번 ├── beforeEach ← 매번 │ └── 테스트 2 │ └── afterEach ← 매번 afterAll ← 1번 4. Mock 함수 vi.fn(implementation?) 가짜 함수 생성, 호출 추적 및 반환값 제어 가능\nimport { vi } from 'vitest' const mockFn = vi.fn() const mockAdd = vi.fn((a, b) =\u003e a + b) mockAdd(1, 2) // 3 사용 목적\n외부 의존성 격리 호출 인자·횟수 검증 상황에 따른 반환값 제어 Mock 함수 메서드 mockReturnValue(value) 항상 동일 값 반환\nconst mockFn = vi.fn() mockFn.mockReturnValue(42) mockFn() // 42 mockReturnValueOnce(value) 지정된 호출 횟수만 특정 값 반환 후 기본 동작\nconst mockFn = vi.fn() mockFn .mockReturnValueOnce(1) .mockReturnValueOnce(2) .mockReturnValue(999)mockResolvedValue(value) Promise.resolve(value) 반환\nconst mockFetch = vi.fn() mockFetch.mockResolvedValue({ data: 'success' }) await mockFetch()동일 표현\nmockFn.mockImplementation(() =\u003e Promise.resolve(value))mockResolvedValueOnce(value) 한 번만 resolve\nmockFn .mockResolvedValueOnce({ page: 1 }) .mockResolvedValueOnce({ page: 2 })mockRejectedValue(error) Promise.reject(error) 반환\nconst mockFetch = vi.fn() mockFetch.mockRejectedValue(new Error('Network error'))mockRejectedValueOnce(error) 한 번만 reject 후 정상 동작 설정 가능\nmockFn .mockRejectedValueOnce(new Error('일시적 에러')) .mockResolvedValue({ success: true })mockImplementation(fn) 구현 자체 교체\nconst mockFn = vi.fn() mockFn.mockImplementation((x, y) =\u003e x * y)조건 분기 예\nmockHttpClient.get.mockImplementation(async (url, params) =\u003e { if (params.page === 1) return { list: [1, 2], totalPage: 2 } if (params.page === 2) return { list: [3, 4], totalPage: 2 } return { list: [], totalPage: 2 } })mockImplementationOnce(fn) 일회성 구현 교체\nmockFn .mockImplementationOnce(() =\u003e 'first') .mockImplementationOnce(() =\u003e 'second') .mockImplementation(() =\u003e 'default')Mock 초기화 메서드 mockClear() 호출 기록만 초기화, 구현은 유지\nconst mockFn = vi.fn().mockReturnValue(42) mockFn() mockFn.mockClear()mockReset() 호출 기록과 구현 초기화, 반환값 undefined로 복귀\nconst mockFn = vi.fn().mockReturnValue(42) mockFn.mockReset()mockRestore() 원본 구현 복구, vi.spyOn으로 만든 spy 대상\nconst obj = { method: () =\u003e 'original' } const spy = vi.spyOn(obj, 'method').mockReturnValue('mocked') spy.mockRestore()전역 Mock 초기화 vi.clearAllMocks() 모든 mock 호출 기록 초기화 vi.resetAllMocks() 호출 기록과 구현 초기화 vi.restoreAllMocks() 모든 spy 원복 beforeEach(() =\u003e { vi.clearAllMocks() })Mock 검증 매처 const mockFn = vi.fn() mockFn() expect(mockFn).toHaveBeenCalled() expect(mockFn).toHaveBeenCalledTimes(1) mockFn('hello', 123) expect(mockFn).toHaveBeenCalledWith('hello', 123) mockFn(1) mockFn(2) mockFn(3) expect(mockFn).toHaveBeenLastCalledWith(3) expect(mockFn).toHaveBeenNthCalledWith(1, 'hello', 123) 5. 모듈 Mocking vi.mock(path, factory?) 모듈 전체를 mock으로 교체, import 이전에 가로채기 수행\nimport { vi } from 'vitest' import { fetchData } from './api' // mock된 상태로 import vi.mock('./api', () =\u003e ({ fetchData: vi.fn(), saveData: vi.fn(), }))동작 원리\nvi.mock은 파일 단위로 호이스팅되어 실제 import보다 먼저 실행 대상 모듈 로딩을 가로채 mock 버전으로 대체 이후 해당 모듈을 import하면 mock된 export 제공 Node 내장 모듈 mock vi.mock('node:fs/promises', () =\u003e ({ readFile: vi.fn(), writeFile: vi.fn(), })) it('파일 읽기 테스트', async () =\u003e { const fs = await import('node:fs/promises') vi.mocked(fs.readFile).mockResolvedValue('file content') })부분 mock 일부만 교체하고 나머지는 실제 구현 유지\nvi.mock('./utils', async (importOriginal) =\u003e { const actual = await importOriginal\u003ctypeof import('./utils')\u003e() return { ...actual, dangerousFunction: vi.fn(), } }) 6. vi.spyOn(object, method) 기존 메서드를 감시, 실제 구현 유지하며 호출·반환 추적 또는 선택적 교체\nconst calculator = { add: (a: number, b: number) =\u003e a + b } const spy = vi.spyOn(calculator, 'add') calculator.add(1, 2) expect(spy).toHaveBeenCalledWith(1, 2) expect(spy).toHaveReturnedWith(3)vi.fn vs vi.spyOn 비교\nvi.fn: 새 mock 함수 생성, 원본 없음, 복구 개념 없음 vi.spyOn: 기존 메서드 감시, 원본 유지, mockRestore로 복구 가능 구현 교체와 복구\nconst spy = vi.spyOn(calculator, 'add') spy.mockImplementation((a, b) =\u003e 0) spy.mockRestore() 7. vi.mocked(fn, deep?) TypeScript 타입 단언 헬퍼, 런타임 영향 없음\nimport { fetchData } from './api' vi.mock('./api') // fetchData.mockResolvedValue(...) 는 타입 에러 vi.mocked(fetchData).mockResolvedValue({ data: 'test' })deep 옵션으로 중첩 메서드까지 mock 타입 적용\nconst mockService = { nested: { method: vi.fn() } } vi.mocked(mockService, true).nested.method.mockReturnValue(1) 8. 비동기 테스트 async/await it('비동기 데이터를 가져온다', async () =\u003e { const data = await fetchData() expect(data).toEqual({ id: 1 }) })resolves / rejects Promise 결과를 직접 검증\nawait expect(asyncFn()).resolves.toBe(42) await expect(asyncFn()).resolves.toEqual({ data: 'success' }) await expect(failingFn()).rejects.toThrow('error') await expect(failingFn()).rejects.toBeInstanceOf(ValidationError) 9. 테스트 제어 it.only / describe.only 특정 테스트만 실행\nit.only('이것만 실행', () =\u003e { /* ... */ }) describe.only('이 그룹만', () =\u003e { /* ... */ })it.skip / describe.skip 특정 테스트 건너뜀\nit.skip('이건 건너뜀', () =\u003e { /* ... */ }) describe.skip('이 그룹 건너뜀', () =\u003e { /* ... */ })it.todo 향후 작성할 테스트 명시\nit.todo('나중에 구현할 테스트') 10. Best Practices 테스트 독립성 유지 // Bad: 테스트 간 상태 공유 let counter = 0 it('테스트1', () =\u003e { counter++ }) it('테스트2', () =\u003e { expect(counter).toBe(1) }) // Good: 매 테스트 초기화 beforeEach(() =\u003e { vi.clearAllMocks() })명확한 테스트 이름 // Bad it('test1', () =\u003e { /* ... */ }) // Good it('유효하지 않은 이메일이면 ValidationError를 던짐', () =\u003e { /* ... */ }) it('페이지가 2개 이상이면 모든 페이지 순회', () =\u003e { /* ... */ })AAA 패턴 적용 it('유저 생성 시 이메일 저장', async () =\u003e { // Arrange const userData = { email: 'test@example.com', name: 'John' } mockRepository.save.mockResolvedValue({ id: 1, ...userData }) // Act const result = await userService.create(userData) // Assert expect(result.email).toBe('test@example.com') expect(mockRepository.save).toHaveBeenCalledWith(userData) })필요한 것만 mock // Bad: 사용하지 않는 메서드까지 mock const mockLogger = { log: vi.fn(), warn: vi.fn(), error: vi.fn(), debug: vi.fn(), verbose: vi.fn(), trace: vi.fn() } // Good: 필요한 메서드만 const mockLogger = { warn: vi.fn() } as unknown as Logger구현이 아닌 동작을 테스트 // Bad: 내부 구현 의존 expect(service['_internalArray']).toContain(item) // Good: 공개 인터페이스 기준 검증 expect(service.getAll()).toContain(item) 11. CLI 명령어 # 전체 테스트 실행 npx vitest run # watch 모드 npx vitest # 특정 파일만 실행 npx vitest user.service.spec.ts # 테스트 이름 패턴 매칭 npx vitest --grep \"유저 생성\" # 커버리지 리포트 npx vitest run --coverage # UI 모드 npx vitest --ui마무리 Vitest는 Vite 생태계와 맞물려 빠른 피드백 루프를 제공함 Jest 호환 API를 활용해 기존 경험을 그대로 가져오면서, 모듈 mocking과 spy, 비동기 매처를 조합해 안정적인 단위 테스트 체계를 구축 가능\n참고자료 https://vitest.dev/guide/ https://vitest.dev/api/ https://vitest.dev/guide/mocking https://jestjs.io/docs/expect https://vitejs.dev/guide/ ","wordCount":"1575","inLanguage":"en","datePublished":"2026-02-01T13:16:32.79Z","dateModified":"2026-02-01T13:16:32.79Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.jsontapose.com/posts/vitest-complete-guide-3d3f4f/"},"publisher":{"@type":"Organization","name":"HandsLog","logo":{"@type":"ImageObject","url":"https://blog.jsontapose.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.jsontapose.com/ accesskey=h title="HandsLog (Alt + H)">HandsLog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.jsontapose.com/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://blog.jsontapose.com/categories/ title=categories><span>categories</span></a></li><li><a href=https://jsontapose.com/ title="compare JSON"><span>compare JSON</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.jsontapose.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.jsontapose.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Vitest 완벽 가이드</h1><div class=post-meta><span title='2026-02-01 13:16:32.79 +0000 UTC'>February 1, 2026</span></div></header><div class=post-content><h3 id=개요>개요<a hidden class=anchor aria-hidden=true href=#개요>#</a></h3><p>Vite 기반의 테스트 프레임워크 Vitest 소개 및 실무 사용 패턴 정리
Jest와 거의 동일한 API를 제공하고, Vite의 ESM/HMR을 활용해 빠른 재실행을 제공함
Vite 프로젝트에서는 최소 설정으로 바로 사용 가능</p><ul><li>빠른 실행과 재실행, watch 효율 높음</li><li>Jest API 호환성 높아 러닝 커브 낮음</li><li>TypeScript 네이티브 지원</li></ul><hr><h2 id=1-기본-구조>1. 기본 구조<a hidden class=anchor aria-hidden=true href=#1-기본-구조>#</a></h2><h3 id=테스트-파일-명명-규칙>테스트 파일 명명 규칙<a hidden class=anchor aria-hidden=true href=#테스트-파일-명명-규칙>#</a></h3><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain><span style=display:flex><span>*.spec.ts     또는     *.test.ts</span></span></code></pre></div><h3 id=describename-fn>describe(name, fn)<a hidden class=anchor aria-hidden=true href=#describename-fn>#</a></h3><p>관련 테스트를 그룹화하는 컨테이너</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>{</span> describe<span style=color:#eceff4>,</span> it<span style=color:#eceff4>,</span> expect <span style=color:#eceff4>}</span> <span style=color:#81a1c1;font-weight:700>from</span> <span style=color:#a3be8c>&#39;vitest&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>describe<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;계산기&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;두 수를 더한다&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    expect<span style=color:#eceff4>(</span><span style=color:#b48ead>1</span> <span style=color:#81a1c1>+</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>).</span>toBe<span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>  <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;두 수를 뺀다&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    expect<span style=color:#eceff4>(</span><span style=color:#b48ead>5</span> <span style=color:#81a1c1>-</span> <span style=color:#b48ead>3</span><span style=color:#eceff4>).</span>toBe<span style=color:#eceff4>(</span><span style=color:#b48ead>2</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>  <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><ul><li>첫 번째 인자: 그룹 이름</li><li>두 번째 인자: 테스트 콜백</li><li>중첩 describe 구성 가능</li></ul><h3 id=itname-fn--testname-fn>it(name, fn) / test(name, fn)<a hidden class=anchor aria-hidden=true href=#itname-fn--testname-fn>#</a></h3><p>개별 테스트 케이스 정의, 두 API는 동일 동작</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;유효한 이메일이면 true를 반환&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  expect<span style=color:#eceff4>(</span>isValidEmail<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;test@example.com&#39;</span><span style=color:#eceff4>)).</span>toBe<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>true</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>test<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;유효한 이메일이면 true를 반환&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  expect<span style=color:#eceff4>(</span>isValidEmail<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;test@example.com&#39;</span><span style=color:#eceff4>)).</span>toBe<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>true</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><h3 id=중첩-describe-출력-예>중첩 describe 출력 예<a hidden class=anchor aria-hidden=true href=#중첩-describe-출력-예>#</a></h3><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>describe<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;UserService&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  describe<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;create&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;유효한 데이터로 유저 생성&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>    it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;중복 이메일이면 에러&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>  <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  describe<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;delete&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;존재하는 유저 삭제&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>  <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain><span style=display:flex><span>UserService
</span></span><span style=display:flex><span>  create
</span></span><span style=display:flex><span>    ✓ 유효한 데이터로 유저 생성
</span></span><span style=display:flex><span>    ✓ 중복 이메일이면 에러
</span></span><span style=display:flex><span>  delete
</span></span><span style=display:flex><span>    ✓ 존재하는 유저 삭제</span></span></code></pre></div><hr><h2 id=2-expect와-매처>2. expect와 매처<a hidden class=anchor aria-hidden=true href=#2-expect와-매처>#</a></h2><h3 id=expectvalue>expect(value)<a hidden class=anchor aria-hidden=true href=#expectvalue>#</a></h3><p>검증 시작점, 다양한 매처 체이닝 지원</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#bf616a>실제값</span><span style=color:#eceff4>).</span>matcher<span style=color:#eceff4>(</span><span style=color:#bf616a>기대값</span><span style=color:#eceff4>)</span></span></span></code></pre></div><h3 id=기본-비교-매처>기본 비교 매처<a hidden class=anchor aria-hidden=true href=#기본-비교-매처>#</a></h3><h4 id=tobeexpected>toBe(expected)<a hidden class=anchor aria-hidden=true href=#tobeexpected>#</a></h4><p>엄격 동등 비교 ===, 원시값 비교에 사용</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#b48ead>1</span> <span style=color:#81a1c1>+</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>).</span>toBe<span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;hello&#39;</span><span style=color:#eceff4>).</span>toBe<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;hello&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>true</span><span style=color:#eceff4>).</span>toBe<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>true</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// 객체/배열은 참조 비교라 실패
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>expect<span style=color:#eceff4>({</span> a: <span style=color:#81a1c1>1</span> <span style=color:#eceff4>}).</span>toBe<span style=color:#eceff4>({</span> a: <span style=color:#81a1c1>1</span> <span style=color:#eceff4>})</span> <span style=color:#616e87;font-style:italic>// 실패
</span></span></span></code></pre></div><h4 id=toequalexpected>toEqual(expected)<a hidden class=anchor aria-hidden=true href=#toequalexpected>#</a></h4><p>깊은 동등 비교, 객체/배열 내용 비교</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>({</span> name<span style=color:#81a1c1>:</span> <span style=color:#a3be8c>&#39;John&#39;</span><span style=color:#eceff4>,</span> age: <span style=color:#81a1c1>30</span> <span style=color:#eceff4>}).</span>toEqual<span style=color:#eceff4>({</span> name<span style=color:#81a1c1>:</span> <span style=color:#a3be8c>&#39;John&#39;</span><span style=color:#eceff4>,</span> age: <span style=color:#81a1c1>30</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>([</span><span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>3</span><span style=color:#eceff4>]).</span>toEqual<span style=color:#eceff4>([</span><span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>3</span><span style=color:#eceff4>])</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>({</span> user<span style=color:#81a1c1>:</span> <span style=color:#eceff4>{</span> name<span style=color:#81a1c1>:</span> <span style=color:#a3be8c>&#39;John&#39;</span> <span style=color:#eceff4>},</span> items<span style=color:#81a1c1>:</span> <span style=color:#eceff4>[</span><span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>]</span> <span style=color:#eceff4>}).</span>toEqual<span style=color:#eceff4>({</span> user<span style=color:#81a1c1>:</span> <span style=color:#eceff4>{</span> name<span style=color:#81a1c1>:</span> <span style=color:#a3be8c>&#39;John&#39;</span> <span style=color:#eceff4>},</span> items<span style=color:#81a1c1>:</span> <span style=color:#eceff4>[</span><span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>]</span> <span style=color:#eceff4>})</span></span></span></code></pre></div><h4 id=tostrictequalexpected>toStrictEqual(expected)<a hidden class=anchor aria-hidden=true href=#tostrictequalexpected>#</a></h4><p>toEqual보다 엄격, undefined 속성·희소 배열·클래스 인스턴스까지 체크</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>({</span> a: <span style=color:#81a1c1>1</span><span style=color:#eceff4>,</span> b: <span style=color:#81a1c1>undefined</span> <span style=color:#eceff4>}).</span>toEqual<span style=color:#eceff4>({</span> a: <span style=color:#81a1c1>1</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>({</span> a: <span style=color:#81a1c1>1</span><span style=color:#eceff4>,</span> b: <span style=color:#81a1c1>undefined</span> <span style=color:#eceff4>}).</span>toStrictEqual<span style=color:#eceff4>({</span> a: <span style=color:#81a1c1>1</span> <span style=color:#eceff4>})</span> <span style=color:#616e87;font-style:italic>// 실패
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>class</span> User <span style=color:#eceff4>{</span> name <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#39;John&#39;</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>new</span> User<span style=color:#eceff4>()).</span>toEqual<span style=color:#eceff4>({</span> name<span style=color:#81a1c1>:</span> <span style=color:#a3be8c>&#39;John&#39;</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>new</span> User<span style=color:#eceff4>()).</span>toStrictEqual<span style=color:#eceff4>({</span> name<span style=color:#81a1c1>:</span> <span style=color:#a3be8c>&#39;John&#39;</span> <span style=color:#eceff4>})</span> <span style=color:#616e87;font-style:italic>// 실패
</span></span></span></code></pre></div><h3 id=truthiness-매처>Truthiness 매처<a hidden class=anchor aria-hidden=true href=#truthiness-매처>#</a></h3><h4 id=tobetruthy--tobefalsy>toBeTruthy / toBeFalsy<a hidden class=anchor aria-hidden=true href=#tobetruthy--tobefalsy>#</a></h4><p>JavaScript truthy/falsy 규칙 기반 검증</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Truthy: 0, &#39;&#39;, null, undefined, NaN, false 외의 모든 값
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>expect<span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>).</span>toBeTruthy<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;hello&#39;</span><span style=color:#eceff4>).</span>toBeTruthy<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>([]).</span>toBeTruthy<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>({}).</span>toBeTruthy<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Falsy: 0, &#39;&#39;, null, undefined, NaN, false
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>expect<span style=color:#eceff4>(</span><span style=color:#b48ead>0</span><span style=color:#eceff4>).</span>toBeFalsy<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;&#39;</span><span style=color:#eceff4>).</span>toBeFalsy<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>null</span><span style=color:#eceff4>).</span>toBeFalsy<span style=color:#eceff4>()</span></span></span></code></pre></div><h4 id=tobenull--tobeundefined--tobedefined>toBeNull / toBeUndefined / toBeDefined<a hidden class=anchor aria-hidden=true href=#tobenull--tobeundefined--tobedefined>#</a></h4><p>명확한 의도 표현에 유용</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>null</span><span style=color:#eceff4>).</span>toBeNull<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>undefined</span><span style=color:#eceff4>).</span>toBeUndefined<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;value&#39;</span><span style=color:#eceff4>).</span>toBeDefined<span style=color:#eceff4>()</span></span></span></code></pre></div><h3 id=숫자-비교-매처>숫자 비교 매처<a hidden class=anchor aria-hidden=true href=#숫자-비교-매처>#</a></h3><h4 id=tobegreaterthan--tobelessthan--tobegreaterthanorequal--tobelessthanorequal>toBeGreaterThan / toBeLessThan / toBeGreaterThanOrEqual / toBeLessThanOrEqual<a hidden class=anchor aria-hidden=true href=#tobegreaterthan--tobelessthan--tobegreaterthanorequal--tobelessthanorequal>#</a></h4><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#b48ead>10</span><span style=color:#eceff4>).</span>toBeGreaterThan<span style=color:#eceff4>(</span><span style=color:#b48ead>5</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#b48ead>10</span><span style=color:#eceff4>).</span>toBeGreaterThanOrEqual<span style=color:#eceff4>(</span><span style=color:#b48ead>10</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>).</span>toBeLessThan<span style=color:#eceff4>(</span><span style=color:#b48ead>5</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>).</span>toBeLessThanOrEqual<span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>)</span></span></span></code></pre></div><h4 id=tobecloseton-precision>toBeCloseTo(n, precision?)<a hidden class=anchor aria-hidden=true href=#tobecloseton-precision>#</a></h4><p>부동소수점 오차 허용 비교, precision 기본값 2</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#b48ead>0.1</span> <span style=color:#81a1c1>+</span> <span style=color:#b48ead>0.2</span><span style=color:#eceff4>).</span>toBeCloseTo<span style=color:#eceff4>(</span><span style=color:#b48ead>0.3</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#b48ead>0.1</span> <span style=color:#81a1c1>+</span> <span style=color:#b48ead>0.2</span><span style=color:#eceff4>).</span>toBeCloseTo<span style=color:#eceff4>(</span><span style=color:#b48ead>0.3</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>5</span><span style=color:#eceff4>)</span></span></span></code></pre></div><h3 id=문자열-매처>문자열 매처<a hidden class=anchor aria-hidden=true href=#문자열-매처>#</a></h3><h4 id=tomatchregexp--string>toMatch(regexp | string)<a hidden class=anchor aria-hidden=true href=#tomatchregexp--string>#</a></h4><p>정규식 또는 부분 문자열 매칭</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;hello world&#39;</span><span style=color:#eceff4>).</span>toMatch<span style=color:#eceff4>(</span><span style=color:#ebcb8b>/world/</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;hello world&#39;</span><span style=color:#eceff4>).</span>toMatch<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;world&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;hello world&#39;</span><span style=color:#eceff4>).</span>toMatch<span style=color:#eceff4>(</span><span style=color:#ebcb8b>/^hello/</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;Error: 404&#39;</span><span style=color:#eceff4>).</span>toMatch<span style=color:#eceff4>(</span><span style=color:#ebcb8b>/Error: \d+/</span><span style=color:#eceff4>)</span></span></span></code></pre></div><h4 id=tocontainitem>toContain(item)<a hidden class=anchor aria-hidden=true href=#tocontainitem>#</a></h4><p>문자열에 부분 문자열 포함 여부</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;hello world&#39;</span><span style=color:#eceff4>).</span>toContain<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;world&#39;</span><span style=color:#eceff4>)</span></span></span></code></pre></div><h3 id=배열이터러블-매처>배열/이터러블 매처<a hidden class=anchor aria-hidden=true href=#배열이터러블-매처>#</a></h3><h4 id=tocontainitem-1>toContain(item)<a hidden class=anchor aria-hidden=true href=#tocontainitem-1>#</a></h4><p>배열에 특정 요소 포함 여부</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>([</span><span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>3</span><span style=color:#eceff4>]).</span>toContain<span style=color:#eceff4>(</span><span style=color:#b48ead>2</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> obj <span style=color:#81a1c1>=</span> <span style=color:#eceff4>{</span> id: <span style=color:#81a1c1>1</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>([</span>obj<span style=color:#eceff4>]).</span>toContain<span style=color:#eceff4>(</span>obj<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>([{</span> id: <span style=color:#81a1c1>1</span> <span style=color:#eceff4>}]).</span>toContain<span style=color:#eceff4>({</span> id: <span style=color:#81a1c1>1</span> <span style=color:#eceff4>})</span> <span style=color:#616e87;font-style:italic>// 실패: 참조 다름
</span></span></span></code></pre></div><h4 id=tocontainequalitem>toContainEqual(item)<a hidden class=anchor aria-hidden=true href=#tocontainequalitem>#</a></h4><p>배열 내 객체를 깊게 비교</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>([{</span> id: <span style=color:#81a1c1>1</span> <span style=color:#eceff4>},</span> <span style=color:#eceff4>{</span> id: <span style=color:#81a1c1>2</span> <span style=color:#eceff4>}]).</span>toContainEqual<span style=color:#eceff4>({</span> id: <span style=color:#81a1c1>1</span> <span style=color:#eceff4>})</span></span></span></code></pre></div><h4 id=tohavelengthn>toHaveLength(n)<a hidden class=anchor aria-hidden=true href=#tohavelengthn>#</a></h4><p>배열·문자열의 길이 검증</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>([</span><span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>3</span><span style=color:#eceff4>]).</span>toHaveLength<span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;hello&#39;</span><span style=color:#eceff4>).</span>toHaveLength<span style=color:#eceff4>(</span><span style=color:#b48ead>5</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>({</span> length: <span style=color:#81a1c1>3</span> <span style=color:#eceff4>}).</span>toHaveLength<span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>)</span></span></span></code></pre></div><h3 id=예외-검증-매처>예외 검증 매처<a hidden class=anchor aria-hidden=true href=#예외-검증-매처>#</a></h3><h4 id=tothrowerror>toThrow(error?)<a hidden class=anchor aria-hidden=true href=#tothrowerror>#</a></h4><p>함수가 에러를 던지는지 검증, 함수 참조를 전달해야 함</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#81a1c1;font-weight:700>throw</span> <span style=color:#81a1c1;font-weight:700>new</span> <span style=color:#81a1c1>Error</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;fail&#39;</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>}).</span>toThrow<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#81a1c1;font-weight:700>throw</span> <span style=color:#81a1c1;font-weight:700>new</span> <span style=color:#81a1c1>Error</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;Invalid email&#39;</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>}).</span>toThrow<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;Invalid email&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#81a1c1;font-weight:700>throw</span> <span style=color:#81a1c1;font-weight:700>new</span> <span style=color:#81a1c1>Error</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;User 123 not found&#39;</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>}).</span>toThrow<span style=color:#eceff4>(</span><span style=color:#ebcb8b>/not found/</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>class</span> ValidationError <span style=color:#81a1c1;font-weight:700>extends</span> <span style=color:#81a1c1>Error</span> <span style=color:#eceff4>{}</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#81a1c1;font-weight:700>throw</span> <span style=color:#81a1c1;font-weight:700>new</span> ValidationError<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;invalid&#39;</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>}).</span>toThrow<span style=color:#eceff4>(</span>ValidationError<span style=color:#eceff4>)</span></span></span></code></pre></div><p>잘못된 사용 예</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#616e87;font-style:italic>// 즉시 실행되어 실패
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>expect<span style=color:#eceff4>(</span>throwingFn<span style=color:#eceff4>()).</span>toThrow<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// 올바른 사용
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>expect<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> throwingFn<span style=color:#eceff4>()).</span>toThrow<span style=color:#eceff4>()</span></span></span></code></pre></div><h4 id=rejectstothrow-비동기-에러>rejects.toThrow 비동기 에러<a hidden class=anchor aria-hidden=true href=#rejectstothrow-비동기-에러>#</a></h4><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>async</span> <span style=color:#81a1c1;font-weight:700>function</span> asyncFail() { <span style=color:#81a1c1;font-weight:700>throw</span> <span style=color:#81a1c1;font-weight:700>new</span> <span style=color:#81a1c1>Error</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;async error&#39;</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>await</span> expect<span style=color:#eceff4>(</span>asyncFail<span style=color:#eceff4>()).</span>rejects<span style=color:#eceff4>.</span>toThrow<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;async error&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>await</span> expect<span style=color:#eceff4>(</span>Promise<span style=color:#eceff4>.</span>reject<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>new</span> <span style=color:#81a1c1>Error</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;fail&#39;</span><span style=color:#eceff4>))).</span>rejects<span style=color:#eceff4>.</span>toThrow<span style=color:#eceff4>()</span></span></span></code></pre></div><h3 id=부정-not>부정 not<a hidden class=anchor aria-hidden=true href=#부정-not>#</a></h3><p>모든 매처 앞에서 반대 조건 검증</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#b48ead>5</span><span style=color:#eceff4>).</span>not<span style=color:#eceff4>.</span>toBe<span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>([</span><span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>]).</span>not<span style=color:#eceff4>.</span>toContain<span style=color:#eceff4>(</span><span style=color:#b48ead>5</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>null</span><span style=color:#eceff4>).</span>not<span style=color:#eceff4>.</span>toBeDefined<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> safeFn<span style=color:#eceff4>()).</span>not<span style=color:#eceff4>.</span>toThrow<span style=color:#eceff4>()</span></span></span></code></pre></div><hr><h2 id=3-setup과-teardown>3. Setup과 Teardown<a hidden class=anchor aria-hidden=true href=#3-setup과-teardown>#</a></h2><h3 id=beforeallfn>beforeAll(fn)<a hidden class=anchor aria-hidden=true href=#beforeallfn>#</a></h3><p>모든 테스트 전 1회 실행, DB 연결·서버 시작 등 공용 리소스 준비</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>{</span> beforeAll <span style=color:#eceff4>}</span> <span style=color:#81a1c1;font-weight:700>from</span> <span style=color:#a3be8c>&#39;vitest&#39;</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>let</span> db: <span style=color:#81a1c1>Database</span>
</span></span><span style=display:flex><span>beforeAll<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>async</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  db <span style=color:#81a1c1>=</span> <span style=color:#81a1c1;font-weight:700>await</span> Database<span style=color:#eceff4>.</span>connect<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><h3 id=afterallfn>afterAll(fn)<a hidden class=anchor aria-hidden=true href=#afterallfn>#</a></h3><p>모든 테스트 후 1회 실행, 리소스 정리</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>{</span> afterAll <span style=color:#eceff4>}</span> <span style=color:#81a1c1;font-weight:700>from</span> <span style=color:#a3be8c>&#39;vitest&#39;</span>
</span></span><span style=display:flex><span>afterAll<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>async</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  <span style=color:#81a1c1;font-weight:700>await</span> db<span style=color:#eceff4>.</span>disconnect<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><h3 id=beforeeachfn>beforeEach(fn)<a hidden class=anchor aria-hidden=true href=#beforeeachfn>#</a></h3><p>각 테스트 전 매번 실행, 상태 격리</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>{</span> beforeEach<span style=color:#eceff4>,</span> vi <span style=color:#eceff4>}</span> <span style=color:#81a1c1;font-weight:700>from</span> <span style=color:#a3be8c>&#39;vitest&#39;</span>
</span></span><span style=display:flex><span>beforeEach<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  vi<span style=color:#eceff4>.</span>clearAllMocks<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><h3 id=aftereachfn>afterEach(fn)<a hidden class=anchor aria-hidden=true href=#aftereachfn>#</a></h3><p>각 테스트 후 매번 실행, 정리 작업</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>{</span> afterEach <span style=color:#eceff4>}</span> <span style=color:#81a1c1;font-weight:700>from</span> <span style=color:#a3be8c>&#39;vitest&#39;</span>
</span></span><span style=display:flex><span>afterEach<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  cleanup<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><p>실행 순서 예시</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain><span style=display:flex><span>beforeAll           ← 1번
</span></span><span style=display:flex><span>  ├── beforeEach    ← 매번
</span></span><span style=display:flex><span>  │   └── 테스트 1
</span></span><span style=display:flex><span>  │   └── afterEach ← 매번
</span></span><span style=display:flex><span>  ├── beforeEach    ← 매번
</span></span><span style=display:flex><span>  │   └── 테스트 2
</span></span><span style=display:flex><span>  │   └── afterEach ← 매번
</span></span><span style=display:flex><span>afterAll            ← 1번</span></span></code></pre></div><hr><h2 id=4-mock-함수>4. Mock 함수<a hidden class=anchor aria-hidden=true href=#4-mock-함수>#</a></h2><h3 id=vifnimplementation>vi.fn(implementation?)<a hidden class=anchor aria-hidden=true href=#vifnimplementation>#</a></h3><p>가짜 함수 생성, 호출 추적 및 반환값 제어 가능</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>{</span> vi <span style=color:#eceff4>}</span> <span style=color:#81a1c1;font-weight:700>from</span> <span style=color:#a3be8c>&#39;vitest&#39;</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> mockFn <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>fn<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> mockAdd <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>fn<span style=color:#eceff4>((</span>a<span style=color:#eceff4>,</span> b<span style=color:#eceff4>)</span> <span style=color:#81a1c1>=&gt;</span> a <span style=color:#81a1c1>+</span> b<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>mockAdd<span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>)</span> <span style=color:#616e87;font-style:italic>// 3
</span></span></span></code></pre></div><p>사용 목적</p><ul><li>외부 의존성 격리</li><li>호출 인자·횟수 검증</li><li>상황에 따른 반환값 제어</li></ul><h3 id=mock-함수-메서드>Mock 함수 메서드<a hidden class=anchor aria-hidden=true href=#mock-함수-메서드>#</a></h3><h4 id=mockreturnvaluevalue>mockReturnValue(value)<a hidden class=anchor aria-hidden=true href=#mockreturnvaluevalue>#</a></h4><p>항상 동일 값 반환</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> mockFn <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>fn<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>mockFn<span style=color:#eceff4>.</span>mockReturnValue<span style=color:#eceff4>(</span><span style=color:#b48ead>42</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>mockFn<span style=color:#eceff4>()</span> <span style=color:#616e87;font-style:italic>// 42
</span></span></span></code></pre></div><h4 id=mockreturnvalueoncevalue>mockReturnValueOnce(value)<a hidden class=anchor aria-hidden=true href=#mockreturnvalueoncevalue>#</a></h4><p>지정된 호출 횟수만 특정 값 반환 후 기본 동작</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> mockFn <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>fn<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>mockFn
</span></span><span style=display:flex><span>  <span style=color:#eceff4>.</span>mockReturnValueOnce<span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>  <span style=color:#eceff4>.</span>mockReturnValueOnce<span style=color:#eceff4>(</span><span style=color:#b48ead>2</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>  <span style=color:#eceff4>.</span>mockReturnValue<span style=color:#eceff4>(</span><span style=color:#b48ead>999</span><span style=color:#eceff4>)</span></span></span></code></pre></div><h4 id=mockresolvedvaluevalue>mockResolvedValue(value)<a hidden class=anchor aria-hidden=true href=#mockresolvedvaluevalue>#</a></h4><p>Promise.resolve(value) 반환</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> mockFetch <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>fn<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>mockFetch<span style=color:#eceff4>.</span>mockResolvedValue<span style=color:#eceff4>({</span> data<span style=color:#81a1c1>:</span> <span style=color:#a3be8c>&#39;success&#39;</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>await</span> mockFetch<span style=color:#eceff4>()</span></span></span></code></pre></div><p>동일 표현</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>mockFn<span style=color:#eceff4>.</span>mockImplementation<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> Promise<span style=color:#eceff4>.</span>resolve<span style=color:#eceff4>(</span>value<span style=color:#eceff4>))</span></span></span></code></pre></div><h4 id=mockresolvedvalueoncevalue>mockResolvedValueOnce(value)<a hidden class=anchor aria-hidden=true href=#mockresolvedvalueoncevalue>#</a></h4><p>한 번만 resolve</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>mockFn
</span></span><span style=display:flex><span>  <span style=color:#eceff4>.</span>mockResolvedValueOnce<span style=color:#eceff4>({</span> page: <span style=color:#81a1c1>1</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>  <span style=color:#eceff4>.</span>mockResolvedValueOnce<span style=color:#eceff4>({</span> page: <span style=color:#81a1c1>2</span> <span style=color:#eceff4>})</span></span></span></code></pre></div><h4 id=mockrejectedvalueerror>mockRejectedValue(error)<a hidden class=anchor aria-hidden=true href=#mockrejectedvalueerror>#</a></h4><p>Promise.reject(error) 반환</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> mockFetch <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>fn<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>mockFetch<span style=color:#eceff4>.</span>mockRejectedValue<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>new</span> <span style=color:#81a1c1>Error</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;Network error&#39;</span><span style=color:#eceff4>))</span></span></span></code></pre></div><h4 id=mockrejectedvalueonceerror>mockRejectedValueOnce(error)<a hidden class=anchor aria-hidden=true href=#mockrejectedvalueonceerror>#</a></h4><p>한 번만 reject 후 정상 동작 설정 가능</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>mockFn
</span></span><span style=display:flex><span>  <span style=color:#eceff4>.</span>mockRejectedValueOnce<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>new</span> <span style=color:#81a1c1>Error</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;일시적 에러&#39;</span><span style=color:#eceff4>))</span>
</span></span><span style=display:flex><span>  <span style=color:#eceff4>.</span>mockResolvedValue<span style=color:#eceff4>({</span> success: <span style=color:#81a1c1>true</span> <span style=color:#eceff4>})</span></span></span></code></pre></div><h4 id=mockimplementationfn>mockImplementation(fn)<a hidden class=anchor aria-hidden=true href=#mockimplementationfn>#</a></h4><p>구현 자체 교체</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> mockFn <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>fn<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>mockFn<span style=color:#eceff4>.</span>mockImplementation<span style=color:#eceff4>((</span>x<span style=color:#eceff4>,</span> y<span style=color:#eceff4>)</span> <span style=color:#81a1c1>=&gt;</span> x <span style=color:#81a1c1>*</span> y<span style=color:#eceff4>)</span></span></span></code></pre></div><p>조건 분기 예</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>mockHttpClient<span style=color:#eceff4>.</span><span style=color:#81a1c1;font-weight:700>get</span><span style=color:#eceff4>.</span>mockImplementation<span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>async</span> <span style=color:#eceff4>(</span>url<span style=color:#eceff4>,</span> params<span style=color:#eceff4>)</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  <span style=color:#81a1c1;font-weight:700>if</span> <span style=color:#eceff4>(</span>params<span style=color:#eceff4>.</span>page <span style=color:#81a1c1>===</span> <span style=color:#b48ead>1</span><span style=color:#eceff4>)</span> <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#eceff4>{</span> list<span style=color:#81a1c1>:</span> <span style=color:#eceff4>[</span><span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>],</span> totalPage: <span style=color:#81a1c1>2</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>  <span style=color:#81a1c1;font-weight:700>if</span> <span style=color:#eceff4>(</span>params<span style=color:#eceff4>.</span>page <span style=color:#81a1c1>===</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>)</span> <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#eceff4>{</span> list<span style=color:#81a1c1>:</span> <span style=color:#eceff4>[</span><span style=color:#b48ead>3</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>4</span><span style=color:#eceff4>],</span> totalPage: <span style=color:#81a1c1>2</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>  <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#eceff4>{</span> list<span style=color:#81a1c1>:</span> <span style=color:#eceff4>[],</span> totalPage: <span style=color:#81a1c1>2</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><h4 id=mockimplementationoncefn>mockImplementationOnce(fn)<a hidden class=anchor aria-hidden=true href=#mockimplementationoncefn>#</a></h4><p>일회성 구현 교체</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>mockFn
</span></span><span style=display:flex><span>  <span style=color:#eceff4>.</span>mockImplementationOnce<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#a3be8c>&#39;first&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>  <span style=color:#eceff4>.</span>mockImplementationOnce<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#a3be8c>&#39;second&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>  <span style=color:#eceff4>.</span>mockImplementation<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#a3be8c>&#39;default&#39;</span><span style=color:#eceff4>)</span></span></span></code></pre></div><h3 id=mock-초기화-메서드>Mock 초기화 메서드<a hidden class=anchor aria-hidden=true href=#mock-초기화-메서드>#</a></h3><h4 id=mockclear>mockClear()<a hidden class=anchor aria-hidden=true href=#mockclear>#</a></h4><p>호출 기록만 초기화, 구현은 유지</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> mockFn <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>fn<span style=color:#eceff4>().</span>mockReturnValue<span style=color:#eceff4>(</span><span style=color:#b48ead>42</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>mockFn<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>mockFn<span style=color:#eceff4>.</span>mockClear<span style=color:#eceff4>()</span></span></span></code></pre></div><h4 id=mockreset>mockReset()<a hidden class=anchor aria-hidden=true href=#mockreset>#</a></h4><p>호출 기록과 구현 초기화, 반환값 undefined로 복귀</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> mockFn <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>fn<span style=color:#eceff4>().</span>mockReturnValue<span style=color:#eceff4>(</span><span style=color:#b48ead>42</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>mockFn<span style=color:#eceff4>.</span>mockReset<span style=color:#eceff4>()</span></span></span></code></pre></div><h4 id=mockrestore>mockRestore()<a hidden class=anchor aria-hidden=true href=#mockrestore>#</a></h4><p>원본 구현 복구, vi.spyOn으로 만든 spy 대상</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> obj <span style=color:#81a1c1>=</span> <span style=color:#eceff4>{</span> method<span style=color:#81a1c1>:</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#a3be8c>&#39;original&#39;</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> spy <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>spyOn<span style=color:#eceff4>(</span>obj<span style=color:#eceff4>,</span> <span style=color:#a3be8c>&#39;method&#39;</span><span style=color:#eceff4>).</span>mockReturnValue<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;mocked&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>spy<span style=color:#eceff4>.</span>mockRestore<span style=color:#eceff4>()</span></span></span></code></pre></div><h3 id=전역-mock-초기화>전역 Mock 초기화<a hidden class=anchor aria-hidden=true href=#전역-mock-초기화>#</a></h3><ul><li>vi.clearAllMocks() 모든 mock 호출 기록 초기화</li><li>vi.resetAllMocks() 호출 기록과 구현 초기화</li><li>vi.restoreAllMocks() 모든 spy 원복</li></ul><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>beforeEach<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  vi<span style=color:#eceff4>.</span>clearAllMocks<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><h3 id=mock-검증-매처>Mock 검증 매처<a hidden class=anchor aria-hidden=true href=#mock-검증-매처>#</a></h3><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> mockFn <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>fn<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>mockFn<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span>mockFn<span style=color:#eceff4>).</span>toHaveBeenCalled<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span>mockFn<span style=color:#eceff4>).</span>toHaveBeenCalledTimes<span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>mockFn<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;hello&#39;</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>123</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span>mockFn<span style=color:#eceff4>).</span>toHaveBeenCalledWith<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;hello&#39;</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>123</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>mockFn<span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>mockFn<span style=color:#eceff4>(</span><span style=color:#b48ead>2</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>mockFn<span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span>mockFn<span style=color:#eceff4>).</span>toHaveBeenLastCalledWith<span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span>mockFn<span style=color:#eceff4>).</span>toHaveBeenNthCalledWith<span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> <span style=color:#a3be8c>&#39;hello&#39;</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>123</span><span style=color:#eceff4>)</span></span></span></code></pre></div><hr><h2 id=5-모듈-mocking>5. 모듈 Mocking<a hidden class=anchor aria-hidden=true href=#5-모듈-mocking>#</a></h2><h3 id=vimockpath-factory>vi.mock(path, factory?)<a hidden class=anchor aria-hidden=true href=#vimockpath-factory>#</a></h3><p>모듈 전체를 mock으로 교체, import 이전에 가로채기 수행</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>{</span> vi <span style=color:#eceff4>}</span> <span style=color:#81a1c1;font-weight:700>from</span> <span style=color:#a3be8c>&#39;vitest&#39;</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>{</span> fetchData <span style=color:#eceff4>}</span> <span style=color:#81a1c1;font-weight:700>from</span> <span style=color:#a3be8c>&#39;./api&#39;</span> <span style=color:#616e87;font-style:italic>// mock된 상태로 import
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>
</span></span><span style=display:flex><span>vi<span style=color:#eceff4>.</span>mock<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;./api&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>({</span>
</span></span><span style=display:flex><span>  fetchData: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>(),</span>
</span></span><span style=display:flex><span>  saveData: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>(),</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}))</span></span></span></code></pre></div><p>동작 원리</p><ol><li>vi.mock은 파일 단위로 호이스팅되어 실제 import보다 먼저 실행</li><li>대상 모듈 로딩을 가로채 mock 버전으로 대체</li><li>이후 해당 모듈을 import하면 mock된 export 제공</li></ol><h3 id=node-내장-모듈-mock>Node 내장 모듈 mock<a hidden class=anchor aria-hidden=true href=#node-내장-모듈-mock>#</a></h3><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>vi<span style=color:#eceff4>.</span>mock<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;node:fs/promises&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>({</span>
</span></span><span style=display:flex><span>  readFile: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>(),</span>
</span></span><span style=display:flex><span>  writeFile: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>(),</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;파일 읽기 테스트&#39;</span><span style=color:#eceff4>,</span> <span style=color:#81a1c1;font-weight:700>async</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  <span style=color:#81a1c1;font-weight:700>const</span> fs <span style=color:#81a1c1>=</span> <span style=color:#81a1c1;font-weight:700>await</span> <span style=color:#81a1c1;font-weight:700>import</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;node:fs/promises&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>  vi<span style=color:#eceff4>.</span>mocked<span style=color:#eceff4>(</span>fs<span style=color:#eceff4>.</span>readFile<span style=color:#eceff4>).</span>mockResolvedValue<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;file content&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><h3 id=부분-mock>부분 mock<a hidden class=anchor aria-hidden=true href=#부분-mock>#</a></h3><p>일부만 교체하고 나머지는 실제 구현 유지</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>vi<span style=color:#eceff4>.</span>mock<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;./utils&#39;</span><span style=color:#eceff4>,</span> <span style=color:#81a1c1;font-weight:700>async</span> <span style=color:#eceff4>(</span>importOriginal<span style=color:#eceff4>)</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  <span style=color:#81a1c1;font-weight:700>const</span> actual <span style=color:#81a1c1>=</span> <span style=color:#81a1c1;font-weight:700>await</span> importOriginal<span style=color:#eceff4>&lt;</span><span style=color:#81a1c1>typeof</span> <span style=color:#8fbcbb>import</span><span style=color:#bf616a>(</span><span style=color:#a3be8c>&#39;./utils&#39;</span><span style=color:#bf616a>)</span><span style=color:#eceff4>&gt;()</span>
</span></span><span style=display:flex><span>  <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    <span style=color:#eceff4>...</span>actual<span style=color:#eceff4>,</span>
</span></span><span style=display:flex><span>    dangerousFunction: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>(),</span>
</span></span><span style=display:flex><span>  <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><hr><h2 id=6-vispyonobject-method>6. vi.spyOn(object, method)<a hidden class=anchor aria-hidden=true href=#6-vispyonobject-method>#</a></h2><p>기존 메서드를 감시, 실제 구현 유지하며 호출·반환 추적 또는 선택적 교체</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> calculator <span style=color:#81a1c1>=</span> <span style=color:#eceff4>{</span> add<span style=color:#81a1c1>:</span> <span style=color:#eceff4>(</span>a: <span style=color:#81a1c1>number</span><span style=color:#eceff4>,</span> b: <span style=color:#81a1c1>number</span><span style=color:#eceff4>)</span> <span style=color:#81a1c1>=&gt;</span> a <span style=color:#81a1c1>+</span> b <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> spy <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>spyOn<span style=color:#eceff4>(</span>calculator<span style=color:#eceff4>,</span> <span style=color:#a3be8c>&#39;add&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>calculator<span style=color:#eceff4>.</span>add<span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span>spy<span style=color:#eceff4>).</span>toHaveBeenCalledWith<span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> <span style=color:#b48ead>2</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>expect<span style=color:#eceff4>(</span>spy<span style=color:#eceff4>).</span>toHaveReturnedWith<span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>)</span></span></span></code></pre></div><p>vi.fn vs vi.spyOn 비교</p><ul><li>vi.fn: 새 mock 함수 생성, 원본 없음, 복구 개념 없음</li><li>vi.spyOn: 기존 메서드 감시, 원본 유지, mockRestore로 복구 가능</li></ul><p>구현 교체와 복구</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> spy <span style=color:#81a1c1>=</span> vi<span style=color:#eceff4>.</span>spyOn<span style=color:#eceff4>(</span>calculator<span style=color:#eceff4>,</span> <span style=color:#a3be8c>&#39;add&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>spy<span style=color:#eceff4>.</span>mockImplementation<span style=color:#eceff4>((</span>a<span style=color:#eceff4>,</span> b<span style=color:#eceff4>)</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#b48ead>0</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>spy<span style=color:#eceff4>.</span>mockRestore<span style=color:#eceff4>()</span></span></span></code></pre></div><hr><h2 id=7-vimockedfn-deep>7. vi.mocked(fn, deep?)<a hidden class=anchor aria-hidden=true href=#7-vimockedfn-deep>#</a></h2><p>TypeScript 타입 단언 헬퍼, 런타임 영향 없음</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>{</span> fetchData <span style=color:#eceff4>}</span> <span style=color:#81a1c1;font-weight:700>from</span> <span style=color:#a3be8c>&#39;./api&#39;</span>
</span></span><span style=display:flex><span>vi<span style=color:#eceff4>.</span>mock<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;./api&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// fetchData.mockResolvedValue(...) 는 타입 에러
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>vi<span style=color:#eceff4>.</span>mocked<span style=color:#eceff4>(</span>fetchData<span style=color:#eceff4>).</span>mockResolvedValue<span style=color:#eceff4>({</span> data<span style=color:#81a1c1>:</span> <span style=color:#a3be8c>&#39;test&#39;</span> <span style=color:#eceff4>})</span></span></span></code></pre></div><p>deep 옵션으로 중첩 메서드까지 mock 타입 적용</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>const</span> mockService <span style=color:#81a1c1>=</span> <span style=color:#eceff4>{</span> nested<span style=color:#81a1c1>:</span> <span style=color:#eceff4>{</span> method: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>()</span> <span style=color:#eceff4>}</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>vi<span style=color:#eceff4>.</span>mocked<span style=color:#eceff4>(</span>mockService<span style=color:#eceff4>,</span> <span style=color:#81a1c1;font-weight:700>true</span><span style=color:#eceff4>).</span>nested<span style=color:#eceff4>.</span>method<span style=color:#eceff4>.</span>mockReturnValue<span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>)</span></span></span></code></pre></div><hr><h2 id=8-비동기-테스트>8. 비동기 테스트<a hidden class=anchor aria-hidden=true href=#8-비동기-테스트>#</a></h2><h3 id=asyncawait>async/await<a hidden class=anchor aria-hidden=true href=#asyncawait>#</a></h3><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;비동기 데이터를 가져온다&#39;</span><span style=color:#eceff4>,</span> <span style=color:#81a1c1;font-weight:700>async</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  <span style=color:#81a1c1;font-weight:700>const</span> data <span style=color:#81a1c1>=</span> <span style=color:#81a1c1;font-weight:700>await</span> fetchData<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span>  expect<span style=color:#eceff4>(</span>data<span style=color:#eceff4>).</span>toEqual<span style=color:#eceff4>({</span> id: <span style=color:#81a1c1>1</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><h3 id=resolves--rejects>resolves / rejects<a hidden class=anchor aria-hidden=true href=#resolves--rejects>#</a></h3><p>Promise 결과를 직접 검증</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>await</span> expect<span style=color:#eceff4>(</span>asyncFn<span style=color:#eceff4>()).</span>resolves<span style=color:#eceff4>.</span>toBe<span style=color:#eceff4>(</span><span style=color:#b48ead>42</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>await</span> expect<span style=color:#eceff4>(</span>asyncFn<span style=color:#eceff4>()).</span>resolves<span style=color:#eceff4>.</span>toEqual<span style=color:#eceff4>({</span> data<span style=color:#81a1c1>:</span> <span style=color:#a3be8c>&#39;success&#39;</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>await</span> expect<span style=color:#eceff4>(</span>failingFn<span style=color:#eceff4>()).</span>rejects<span style=color:#eceff4>.</span>toThrow<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;error&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>await</span> expect<span style=color:#eceff4>(</span>failingFn<span style=color:#eceff4>()).</span>rejects<span style=color:#eceff4>.</span>toBeInstanceOf<span style=color:#eceff4>(</span>ValidationError<span style=color:#eceff4>)</span></span></span></code></pre></div><hr><h2 id=9-테스트-제어>9. 테스트 제어<a hidden class=anchor aria-hidden=true href=#9-테스트-제어>#</a></h2><h3 id=itonly--describeonly>it.only / describe.only<a hidden class=anchor aria-hidden=true href=#itonly--describeonly>#</a></h3><p>특정 테스트만 실행</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>it<span style=color:#eceff4>.</span>only<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;이것만 실행&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>describe<span style=color:#eceff4>.</span>only<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;이 그룹만&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>})</span></span></span></code></pre></div><h3 id=itskip--describeskip>it.skip / describe.skip<a hidden class=anchor aria-hidden=true href=#itskip--describeskip>#</a></h3><p>특정 테스트 건너뜀</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>it<span style=color:#eceff4>.</span>skip<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;이건 건너뜀&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>describe<span style=color:#eceff4>.</span>skip<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;이 그룹 건너뜀&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>})</span></span></span></code></pre></div><h3 id=ittodo>it.todo<a hidden class=anchor aria-hidden=true href=#ittodo>#</a></h3><p>향후 작성할 테스트 명시</p><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>it<span style=color:#eceff4>.</span>todo<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;나중에 구현할 테스트&#39;</span><span style=color:#eceff4>)</span></span></span></code></pre></div><hr><h2 id=10-best-practices>10. Best Practices<a hidden class=anchor aria-hidden=true href=#10-best-practices>#</a></h2><h3 id=테스트-독립성-유지>테스트 독립성 유지<a hidden class=anchor aria-hidden=true href=#테스트-독립성-유지>#</a></h3><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Bad: 테스트 간 상태 공유
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span><span style=color:#81a1c1;font-weight:700>let</span> counter <span style=color:#81a1c1>=</span> <span style=color:#b48ead>0</span>
</span></span><span style=display:flex><span>it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;테스트1&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> counter<span style=color:#81a1c1>++</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;테스트2&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> expect<span style=color:#eceff4>(</span>counter<span style=color:#eceff4>).</span>toBe<span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Good: 매 테스트 초기화
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>beforeEach<span style=color:#eceff4>(()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  vi<span style=color:#eceff4>.</span>clearAllMocks<span style=color:#eceff4>()</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><h3 id=명확한-테스트-이름>명확한 테스트 이름<a hidden class=anchor aria-hidden=true href=#명확한-테스트-이름>#</a></h3><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Bad
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;test1&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Good
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;유효하지 않은 이메일이면 ValidationError를 던짐&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;페이지가 2개 이상이면 모든 페이지 순회&#39;</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>})</span></span></span></code></pre></div><h3 id=aaa-패턴-적용>AAA 패턴 적용<a hidden class=anchor aria-hidden=true href=#aaa-패턴-적용>#</a></h3><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>it<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;유저 생성 시 이메일 저장&#39;</span><span style=color:#eceff4>,</span> <span style=color:#81a1c1;font-weight:700>async</span> <span style=color:#eceff4>()</span> <span style=color:#81a1c1>=&gt;</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  <span style=color:#616e87;font-style:italic>// Arrange
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>  <span style=color:#81a1c1;font-weight:700>const</span> userData <span style=color:#81a1c1>=</span> <span style=color:#eceff4>{</span> email<span style=color:#81a1c1>:</span> <span style=color:#a3be8c>&#39;test@example.com&#39;</span><span style=color:#eceff4>,</span> name<span style=color:#81a1c1>:</span> <span style=color:#a3be8c>&#39;John&#39;</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>  mockRepository<span style=color:#eceff4>.</span>save<span style=color:#eceff4>.</span>mockResolvedValue<span style=color:#eceff4>({</span> id: <span style=color:#81a1c1>1</span><span style=color:#eceff4>,</span> <span style=color:#eceff4>...</span>userData <span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>  <span style=color:#616e87;font-style:italic>// Act
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>  <span style=color:#81a1c1;font-weight:700>const</span> result <span style=color:#81a1c1>=</span> <span style=color:#81a1c1;font-weight:700>await</span> userService<span style=color:#eceff4>.</span>create<span style=color:#eceff4>(</span>userData<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>  <span style=color:#616e87;font-style:italic>// Assert
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>  expect<span style=color:#eceff4>(</span>result<span style=color:#eceff4>.</span>email<span style=color:#eceff4>).</span>toBe<span style=color:#eceff4>(</span><span style=color:#a3be8c>&#39;test@example.com&#39;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>  expect<span style=color:#eceff4>(</span>mockRepository<span style=color:#eceff4>.</span>save<span style=color:#eceff4>).</span>toHaveBeenCalledWith<span style=color:#eceff4>(</span>userData<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>})</span></span></span></code></pre></div><h3 id=필요한-것만-mock>필요한 것만 mock<a hidden class=anchor aria-hidden=true href=#필요한-것만-mock>#</a></h3><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Bad: 사용하지 않는 메서드까지 mock
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span><span style=color:#81a1c1;font-weight:700>const</span> mockLogger <span style=color:#81a1c1>=</span> <span style=color:#eceff4>{</span> log: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>(),</span> warn: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>(),</span> error: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>(),</span> debug: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>(),</span> verbose: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>(),</span> trace: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>()</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Good: 필요한 메서드만
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span><span style=color:#81a1c1;font-weight:700>const</span> mockLogger <span style=color:#81a1c1>=</span> <span style=color:#eceff4>{</span> warn: <span style=color:#81a1c1>vi.fn</span><span style=color:#eceff4>()</span> <span style=color:#eceff4>}</span> <span style=color:#81a1c1;font-weight:700>as</span> <span style=color:#81a1c1>unknown</span> <span style=color:#81a1c1;font-weight:700>as</span> Logger</span></span></code></pre></div><h3 id=구현이-아닌-동작을-테스트>구현이 아닌 동작을 테스트<a hidden class=anchor aria-hidden=true href=#구현이-아닌-동작을-테스트>#</a></h3><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Bad: 내부 구현 의존
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>expect<span style=color:#eceff4>(</span>service<span style=color:#eceff4>[</span><span style=color:#a3be8c>&#39;_internalArray&#39;</span><span style=color:#eceff4>]).</span>toContain<span style=color:#eceff4>(</span>item<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Good: 공개 인터페이스 기준 검증
</span></span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic></span>expect<span style=color:#eceff4>(</span>service<span style=color:#eceff4>.</span>getAll<span style=color:#eceff4>()).</span>toContain<span style=color:#eceff4>(</span>item<span style=color:#eceff4>)</span></span></span></code></pre></div><hr><h2 id=11-cli-명령어>11. CLI 명령어<a hidden class=anchor aria-hidden=true href=#11-cli-명령어>#</a></h2><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#616e87;font-style:italic># 전체 테스트 실행</span>
</span></span><span style=display:flex><span>npx vitest run
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic># watch 모드</span>
</span></span><span style=display:flex><span>npx vitest
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic># 특정 파일만 실행</span>
</span></span><span style=display:flex><span>npx vitest user.service.spec.ts
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic># 테스트 이름 패턴 매칭</span>
</span></span><span style=display:flex><span>npx vitest --grep <span style=color:#a3be8c>&#34;유저 생성&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic># 커버리지 리포트</span>
</span></span><span style=display:flex><span>npx vitest run --coverage
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic># UI 모드</span>
</span></span><span style=display:flex><span>npx vitest --ui</span></span></code></pre></div><h3 id=마무리>마무리<a hidden class=anchor aria-hidden=true href=#마무리>#</a></h3><p>Vitest는 Vite 생태계와 맞물려 빠른 피드백 루프를 제공함
Jest 호환 API를 활용해 기존 경험을 그대로 가져오면서, 모듈 mocking과 spy, 비동기 매처를 조합해 안정적인 단위 테스트 체계를 구축 가능</p><h3 id=참고자료>참고자료<a hidden class=anchor aria-hidden=true href=#참고자료>#</a></h3><ul><li><a href=https://vitest.dev/guide/>https://vitest.dev/guide/</a></li><li><a href=https://vitest.dev/api/>https://vitest.dev/api/</a></li><li><a href=https://vitest.dev/guide/mocking>https://vitest.dev/guide/mocking</a></li><li><a href=https://jestjs.io/docs/expect>https://jestjs.io/docs/expect</a></li><li><a href=https://vitejs.dev/guide/>https://vitejs.dev/guide/</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.jsontapose.com/tags/vitest/>Vitest</a></li><li><a href=https://blog.jsontapose.com/tags/vite/>Vite</a></li><li><a href=https://blog.jsontapose.com/tags/jest-compatibility/>Jest-Compatibility</a></li><li><a href=https://blog.jsontapose.com/tags/testing/>Testing</a></li><li><a href=https://blog.jsontapose.com/tags/unit-testing/>Unit-Testing</a></li><li><a href=https://blog.jsontapose.com/tags/typescript/>Typescript</a></li><li><a href=https://blog.jsontapose.com/tags/mocking/>Mocking</a></li><li><a href=https://blog.jsontapose.com/tags/spying/>Spying</a></li><li><a href=https://blog.jsontapose.com/tags/node/>Node</a></li><li><a href=https://blog.jsontapose.com/tags/cli/>Cli</a></li></ul><nav class=paginav><a class=prev href=https://blog.jsontapose.com/posts/vite-esm-esbuild-rollup-overview-dc5ca1/><span class=title>« Prev</span><br><span>Vite 개요와 작동 원리 — ESM 기반 개발 서버, esbuild 프리번들, Rollup 빌드</span>
</a><a class=next href=https://blog.jsontapose.com/posts/class-transformer-expose-exclude-type-plain-to-instance-exclude-extraneous-values-8baf8a/><span class=title>Next »</span><br><span>class-transformer의 @Expose/@Exclude, @Type, plainToInstance, excludeExtraneousValues 정확히 이해하고 쓰기</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Vitest 완벽 가이드 on x" href="https://x.com/intent/tweet/?text=Vitest%20%ec%99%84%eb%b2%bd%20%ea%b0%80%ec%9d%b4%eb%93%9c&amp;url=https%3a%2f%2fblog.jsontapose.com%2fposts%2fvitest-complete-guide-3d3f4f%2f&amp;hashtags=vitest%2cvite%2cjest-compatibility%2ctesting%2cunit-testing%2ctypescript%2cmocking%2cspying%2cnode%2ccli"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Vitest 완벽 가이드 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.jsontapose.com%2fposts%2fvitest-complete-guide-3d3f4f%2f&amp;title=Vitest%20%ec%99%84%eb%b2%bd%20%ea%b0%80%ec%9d%b4%eb%93%9c&amp;summary=Vitest%20%ec%99%84%eb%b2%bd%20%ea%b0%80%ec%9d%b4%eb%93%9c&amp;source=https%3a%2f%2fblog.jsontapose.com%2fposts%2fvitest-complete-guide-3d3f4f%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Vitest 완벽 가이드 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.jsontapose.com%2fposts%2fvitest-complete-guide-3d3f4f%2f&title=Vitest%20%ec%99%84%eb%b2%bd%20%ea%b0%80%ec%9d%b4%eb%93%9c"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Vitest 완벽 가이드 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.jsontapose.com%2fposts%2fvitest-complete-guide-3d3f4f%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Vitest 완벽 가이드 on whatsapp" href="https://api.whatsapp.com/send?text=Vitest%20%ec%99%84%eb%b2%bd%20%ea%b0%80%ec%9d%b4%eb%93%9c%20-%20https%3a%2f%2fblog.jsontapose.com%2fposts%2fvitest-complete-guide-3d3f4f%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Vitest 완벽 가이드 on telegram" href="https://telegram.me/share/url?text=Vitest%20%ec%99%84%eb%b2%bd%20%ea%b0%80%ec%9d%b4%eb%93%9c&amp;url=https%3a%2f%2fblog.jsontapose.com%2fposts%2fvitest-complete-guide-3d3f4f%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Vitest 완벽 가이드 on ycombinator" href="https://news.ycombinator.com/submitlink?t=Vitest%20%ec%99%84%eb%b2%bd%20%ea%b0%80%ec%9d%b4%eb%93%9c&u=https%3a%2f%2fblog.jsontapose.com%2fposts%2fvitest-complete-guide-3d3f4f%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://blog.jsontapose.com/>HandsLog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>