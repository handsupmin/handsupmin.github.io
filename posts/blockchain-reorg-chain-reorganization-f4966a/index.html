<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>블록체인 Reorg(체인 재구성) 이해 | HandsLog</title>
<meta name=keywords content="blockchain,reorg,chain reorganization,consensus,confirmation"><meta name=description content="개념과 배경
Reorg는 동시에 생성된 블록로 체인이 잠시 분기된 뒤 합의 규칙에 따라 더 우세한 분기로 갈아타는 상황을 뜻함
짧아진 분기에 있던 블록은 활성 체인에서 제외되어 존재하지 않았던 것으로 취급됨
노드는 자신의 로컬 관점에서 더 우세한 체인을 발견하면 그 체인으로 교체하는데 이 현상은 네트워크 전체가 동시에 일어나는 게 아니라 각 노드에서 국소적으로 발생함
핵심 용어 정리


스테일 블록 best chain에 편입되지 못한 정상 블록을 말함


오펀 블록 전통적으로 부모를 모르는 블록을 의미하지만 커뮤니티에선 스테일 블록과 혼용되는 경우가 많음"><meta name=author content><link rel=canonical href=https://blog.jsontapose.com/posts/blockchain-reorg-chain-reorganization-f4966a/><link crossorigin=anonymous href=/assets/css/stylesheet.08f7d74f0ada0f975d29ae436285b61ed7a719d05f350cb888d00341642995a2.css integrity="sha256-CPfXTwraD5ddKa5DYoW2HtenGdBfNQy4iNADQWQplaI=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.jsontapose.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.jsontapose.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.jsontapose.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.jsontapose.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.jsontapose.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/json href=https://blog.jsontapose.com/posts/blockchain-reorg-chain-reorganization-f4966a/index.json><link rel=alternate hreflang=en href=https://blog.jsontapose.com/posts/blockchain-reorg-chain-reorganization-f4966a/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=module>
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

  const isDark = () =>
    document.body.classList.contains("dark") ||
    window.matchMedia?.("(prefers-color-scheme: dark)")?.matches;

  const getThemeOptions = () => {
    const dark = isDark();
    return {
      startOnLoad: false,
      securityLevel: "loose", 
      theme: dark ? "dark" : "default",
      themeVariables: dark
        ? {
            primaryColor: "#0f172a"  ,
            primaryTextColor: "#e5e7eb"  ,
            primaryBorderColor: "#94a3b8"  ,
            lineColor: "#94a3b8",
            textColor: "#e5e7eb",
            nodeTextColor: "#e5e7eb",
            edgeLabelBackground: "#0f172a",
          }
        : {
            primaryColor: "#f8fafc"  ,
            primaryTextColor: "#111827",
            primaryBorderColor: "#374151",
            lineColor: "#374151",
            textColor: "#111827",
            nodeTextColor: "#111827",
            edgeLabelBackground: "#ffffff",
          },
    };
  };

  const renderMermaid = () => {
    
    document.querySelectorAll(".mermaid[data-processed]").forEach((el) => {
      el.removeAttribute("data-processed");
    });
    mermaid.initialize(getThemeOptions());
    mermaid.run({ querySelector: ".mermaid" });
  };

  
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", renderMermaid, {
      once: true,
    });
  } else {
    renderMermaid();
  }

  
  const btn = document.getElementById("theme-toggle");
  if (btn) {
    btn.addEventListener("click", () => {
      
      setTimeout(renderMermaid, 0);
    });
  }

  
  const mql = window.matchMedia?.("(prefers-color-scheme: dark)");
  if (mql && mql.addEventListener) {
    mql.addEventListener("change", renderMermaid);
  }
</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NKJRT1NC1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6NKJRT1NC1")</script><meta name=google-adsense-account content="ca-pub-6022353980017733"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6022353980017733" crossorigin=anonymous></script><meta property="og:url" content="https://blog.jsontapose.com/posts/blockchain-reorg-chain-reorganization-f4966a/"><meta property="og:site_name" content="HandsLog"><meta property="og:title" content="블록체인 Reorg(체인 재구성) 이해"><meta property="og:description" content="개념과 배경 Reorg는 동시에 생성된 블록로 체인이 잠시 분기된 뒤 합의 규칙에 따라 더 우세한 분기로 갈아타는 상황을 뜻함 짧아진 분기에 있던 블록은 활성 체인에서 제외되어 존재하지 않았던 것으로 취급됨 노드는 자신의 로컬 관점에서 더 우세한 체인을 발견하면 그 체인으로 교체하는데 이 현상은 네트워크 전체가 동시에 일어나는 게 아니라 각 노드에서 국소적으로 발생함
핵심 용어 정리 스테일 블록 best chain에 편입되지 못한 정상 블록을 말함
오펀 블록 전통적으로 부모를 모르는 블록을 의미하지만 커뮤니티에선 스테일 블록과 혼용되는 경우가 많음"><meta property="og:locale" content="ko-kr"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-28T13:05:58+00:00"><meta property="article:modified_time" content="2025-09-28T13:05:58+00:00"><meta property="article:tag" content="Blockchain"><meta property="article:tag" content="Reorg"><meta property="article:tag" content="Chain Reorganization"><meta property="article:tag" content="Consensus"><meta property="article:tag" content="Confirmation"><meta name=twitter:card content="summary"><meta name=twitter:title content="블록체인 Reorg(체인 재구성) 이해"><meta name=twitter:description content="개념과 배경
Reorg는 동시에 생성된 블록로 체인이 잠시 분기된 뒤 합의 규칙에 따라 더 우세한 분기로 갈아타는 상황을 뜻함
짧아진 분기에 있던 블록은 활성 체인에서 제외되어 존재하지 않았던 것으로 취급됨
노드는 자신의 로컬 관점에서 더 우세한 체인을 발견하면 그 체인으로 교체하는데 이 현상은 네트워크 전체가 동시에 일어나는 게 아니라 각 노드에서 국소적으로 발생함
핵심 용어 정리


스테일 블록 best chain에 편입되지 못한 정상 블록을 말함


오펀 블록 전통적으로 부모를 모르는 블록을 의미하지만 커뮤니티에선 스테일 블록과 혼용되는 경우가 많음"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.jsontapose.com/posts/"},{"@type":"ListItem","position":2,"name":"블록체인 Reorg(체인 재구성) 이해","item":"https://blog.jsontapose.com/posts/blockchain-reorg-chain-reorganization-f4966a/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"블록체인 Reorg(체인 재구성) 이해","name":"블록체인 Reorg(체인 재구성) 이해","description":"개념과 배경 Reorg는 동시에 생성된 블록로 체인이 잠시 분기된 뒤 합의 규칙에 따라 더 우세한 분기로 갈아타는 상황을 뜻함 짧아진 분기에 있던 블록은 활성 체인에서 제외되어 존재하지 않았던 것으로 취급됨 노드는 자신의 로컬 관점에서 더 우세한 체인을 발견하면 그 체인으로 교체하는데 이 현상은 네트워크 전체가 동시에 일어나는 게 아니라 각 노드에서 국소적으로 발생함\n핵심 용어 정리 스테일 블록 best chain에 편입되지 못한 정상 블록을 말함\n오펀 블록 전통적으로 부모를 모르는 블록을 의미하지만 커뮤니티에선 스테일 블록과 혼용되는 경우가 많음\n","keywords":["blockchain","reorg","chain reorganization","consensus","confirmation"],"articleBody":"개념과 배경 Reorg는 동시에 생성된 블록로 체인이 잠시 분기된 뒤 합의 규칙에 따라 더 우세한 분기로 갈아타는 상황을 뜻함 짧아진 분기에 있던 블록은 활성 체인에서 제외되어 존재하지 않았던 것으로 취급됨 노드는 자신의 로컬 관점에서 더 우세한 체인을 발견하면 그 체인으로 교체하는데 이 현상은 네트워크 전체가 동시에 일어나는 게 아니라 각 노드에서 국소적으로 발생함\n핵심 용어 정리 스테일 블록 best chain에 편입되지 못한 정상 블록을 말함\n오펀 블록 전통적으로 부모를 모르는 블록을 의미하지만 커뮤니티에선 스테일 블록과 혼용되는 경우가 많음\n리오그 깊이 교체되는 블록의 개수로 측정함\n메인 체인 선택 규칙\nPoW에선 누적 작업량이 큰 체인이 우선됨 이더리움 PoS에선 LMD-GHOST 포크초이스를 따르되 마지막 최종화 지점 하위만 후보가 됨 왜 리오그가 생김 네트워크 지연이나 전파 경합으로 같은 높이의 블록이 동시에 생성됨 일부 노드는 A를, 다른 노드는 B를 바탕으로 다음 블록을 쌓음 시간이 지나 우세한 체인이 결정되면 노드가 그 체인으로 교체함 버려진 체인의 트랜잭션은 소실되는 게 아니라 다시 메모풀로 돌아가 재포함을 기다림 합의별 리오그의 차이 PoW 계열 직관 우세 체인 기준은 블록 수가 아니라 누적 작업량임 자연 발생 리오그는 보통 깊이 1에서 끝남 보안 관례로 비트코인은 6컨펌 정도를 사람·서비스가 안전 구간으로 삼는 경우가 많음 다수 해시 파워를 가진 상대는 더 깊은 리오그를 인위적으로 만들 수 있으므로 고가치 결제일수록 더 많은 컨펌을 기다리는 전략이 쓰임 이더리움 PoS 직관 슬롯은 12초, 32슬롯이 1에폭이며 포크초이스는 LMD-GHOST와 FFG 최종화 규칙을 함께 사용함 헤드는 가장 최근 가중치가 높은 체인 머리, 세이프 헤드는 보수적 추정, 파이널라이즈드는 FFG로 최종화된 체크포인트 아래 체인 상태를 뜻함 정상 조건에선 리오그 깊이가 작고 파이널라이즈드 이후로의 리오그는 대규모 비정상 행동 없이는 사실상 불가에 가까움 대략 두 개의 에폭이 지나면 보통 최종화되어 실사용에선 약 12분 남짓을 강한 확정 구간으로 본다는 관례가 있음 환경과 네트워크 상황에 따라 달라질 수 있음 L2에서의 리오그 관점 L2→L1 메시지는 L1에 기록되고 관련 규칙을 충족하면 재전송하지 않음 옵티미스틱 롤업은 챌린지 윈도우가 지나야 강한 확정으로 취급하며 그 전에는 지연을 감안해야 함 L1이 뒤집히는 아주 이례적인 상황을 제외하면 L1에 최종적으로 기록된 상태는 다시 뒤집히지 않는다는 점을 전제로 시스템을 설계함 리오그와 헷갈리기 쉬운 것들 RBF나 수수료 경쟁으로 인해 메모풀에서 트랜잭션이 교체되는 현상은 리오그와 별개임 프로토콜 업그레이드를 위한 하드포크는 합의 규칙 자체를 바꾸는 이벤트이며 자연 발생 리오그와는 범주가 다름 과거 이더리움 PoW 시절의 옴머 포함은 스테일 블록 보상 메커니즘일 뿐 리오그 자체가 아님 서비스 설계에 미치는 영향 결제와 출금\n자산·위험도·체인별로 컨펌 수 정책을 문서화해 운영함 고가치 결제는 더 많은 컨펌을 요구하고 저가치·소액은 사용자 경험을 위해 낮출 수 있음 데이터 처리\n인덱싱은 높이만 저장하지 말고 블록 해시와 부모 해시를 함께 저장 리오그 감지 시 롤백 가능한 저널을 두고 되감기 후 재처리 트랜잭션 처리\n멱등성 확보를 위해 논스·컨트랙트 상태·이벤트 ID를 함께 검증 재방송은 동일 논스로 수행해 중복 실행을 피함 UX\n잠정 상태 표시와 컨펌 카운터 제공 세이프 헤드와 파이널라이즈드의 차이를 사용자에게 명확히 안내 리오그 감지와 대응 패턴 헤드 해시 변화 모니터링과 특정 깊이 이상 변화시 경보\n최신 N개 블록의 체인ID·높이·해시·부모 해시·도착 시각을 원장과 별도 테이블에 윈도우로 관리\n확정 레벨별로 파이프라인을 분기\n헤드 기준 실시간 기능 세이프 기준 중요 알림 파이널 기준 영구 저장 간단 의사코드\nonNewBlock(b): save(b.height, b.hash, b.parent) if parentNotHead(): // reorg 발생 rollbackUntilCommonAncestor() replayFromAncestor() routePipelinesByCommitment(head, safe, finalized)운영 체크리스트 컨펌 정책과 리오그 최대 허용 깊도가 문서화되어 있음 인덱서가 롤백과 재처리를 지원함 알림 시스템이 헤드 전환과 리오그 이벤트를 기록함 파이널라이즈드 구간만 영구 저장하거나 백그라운드 확정화 작업을 운영함 L2의 챌린지 윈도우와 브리지 지연을 고려해 타임라인을 설계함 간단 시나리오 한국과 미국에서 같은 높이 블록이 동시에 생성됨 각 지역 노드가 자신이 먼저 본 블록 위로 다음 블록을 쌓음 한쪽 체인이 한 블록 더 빨리 쌓이며 우세해지면 다른 쪽은 스테일 처리됨 스테일 체인에 있던 거래는 메모풀로 돌아가 메인 체인에 재포함을 기다림\n참고자료 https://en.bitcoin.it/wiki/Chain_Reorganization?utm_source=chatgpt.com https://learnmeabitcoin.com/technical/blockchain/chain-reorganization/?utm_source=chatgpt.com https://ethereum.org/en/developers/docs/consensus-mechanisms/pos/?utm_source=chatgpt.com https://ethereum.org/en/developers/docs/scaling/optimistic-rollups/?utm_source=chatgpt.com https://www.alchemy.com/overviews/ethereum-commitment-levels?utm_source=chatgpt.com ","wordCount":"573","inLanguage":"en","datePublished":"2025-09-28T13:05:58.794Z","dateModified":"2025-09-28T13:05:58.794Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.jsontapose.com/posts/blockchain-reorg-chain-reorganization-f4966a/"},"publisher":{"@type":"Organization","name":"HandsLog","logo":{"@type":"ImageObject","url":"https://blog.jsontapose.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.jsontapose.com/ accesskey=h title="HandsLog (Alt + H)">HandsLog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.jsontapose.com/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://blog.jsontapose.com/categories/ title=categories><span>categories</span></a></li><li><a href=https://jsontapose.com/ title="compare JSON"><span>compare JSON</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.jsontapose.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.jsontapose.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">블록체인 Reorg(체인 재구성) 이해</h1><div class=post-meta><span title='2025-09-28 13:05:58.794 +0000 UTC'>September 28, 2025</span></div></header><div class=post-content><h2 id=개념과-배경>개념과 배경<a hidden class=anchor aria-hidden=true href=#개념과-배경>#</a></h2><p>Reorg는 동시에 생성된 블록로 체인이 잠시 분기된 뒤 합의 규칙에 따라 더 우세한 분기로 갈아타는 상황을 뜻함
짧아진 분기에 있던 블록은 활성 체인에서 제외되어 존재하지 않았던 것으로 취급됨
노드는 자신의 로컬 관점에서 더 우세한 체인을 발견하면 그 체인으로 교체하는데 이 현상은 네트워크 전체가 동시에 일어나는 게 아니라 각 노드에서 국소적으로 발생함</p><h2 id=핵심-용어-정리>핵심 용어 정리<a hidden class=anchor aria-hidden=true href=#핵심-용어-정리>#</a></h2><ul><li><p>스테일 블록 best chain에 편입되지 못한 정상 블록을 말함</p></li><li><p>오펀 블록 전통적으로 부모를 모르는 블록을 의미하지만 커뮤니티에선 스테일 블록과 혼용되는 경우가 많음</p></li><li><p>리오그 깊이 교체되는 블록의 개수로 측정함</p></li><li><p>메인 체인 선택 규칙</p><ul><li>PoW에선 누적 작업량이 큰 체인이 우선됨</li><li>이더리움 PoS에선 LMD-GHOST 포크초이스를 따르되 마지막 최종화 지점 하위만 후보가 됨</li></ul></li></ul><h2 id=왜-리오그가-생김>왜 리오그가 생김<a hidden class=anchor aria-hidden=true href=#왜-리오그가-생김>#</a></h2><ul><li>네트워크 지연이나 전파 경합으로 같은 높이의 블록이 동시에 생성됨</li><li>일부 노드는 A를, 다른 노드는 B를 바탕으로 다음 블록을 쌓음</li><li>시간이 지나 우세한 체인이 결정되면 노드가 그 체인으로 교체함</li><li>버려진 체인의 트랜잭션은 소실되는 게 아니라 다시 메모풀로 돌아가 재포함을 기다림</li></ul><h2 id=합의별-리오그의-차이>합의별 리오그의 차이<a hidden class=anchor aria-hidden=true href=#합의별-리오그의-차이>#</a></h2><h3 id=pow-계열-직관>PoW 계열 직관<a hidden class=anchor aria-hidden=true href=#pow-계열-직관>#</a></h3><ul><li>우세 체인 기준은 블록 수가 아니라 누적 작업량임</li><li>자연 발생 리오그는 보통 깊이 1에서 끝남</li><li>보안 관례로 비트코인은 6컨펌 정도를 사람·서비스가 안전 구간으로 삼는 경우가 많음</li><li>다수 해시 파워를 가진 상대는 더 깊은 리오그를 인위적으로 만들 수 있으므로 고가치 결제일수록 더 많은 컨펌을 기다리는 전략이 쓰임</li></ul><h3 id=이더리움-pos-직관>이더리움 PoS 직관<a hidden class=anchor aria-hidden=true href=#이더리움-pos-직관>#</a></h3><ul><li>슬롯은 12초, 32슬롯이 1에폭이며 포크초이스는 LMD-GHOST와 FFG 최종화 규칙을 함께 사용함</li><li>헤드는 가장 최근 가중치가 높은 체인 머리, 세이프 헤드는 보수적 추정, 파이널라이즈드는 FFG로 최종화된 체크포인트 아래 체인 상태를 뜻함</li><li>정상 조건에선 리오그 깊이가 작고 파이널라이즈드 이후로의 리오그는 대규모 비정상 행동 없이는 사실상 불가에 가까움</li><li>대략 두 개의 에폭이 지나면 보통 최종화되어 실사용에선 약 12분 남짓을 강한 확정 구간으로 본다는 관례가 있음 환경과 네트워크 상황에 따라 달라질 수 있음</li></ul><h2 id=l2에서의-리오그-관점>L2에서의 리오그 관점<a hidden class=anchor aria-hidden=true href=#l2에서의-리오그-관점>#</a></h2><ul><li>L2→L1 메시지는 L1에 기록되고 관련 규칙을 충족하면 재전송하지 않음</li><li>옵티미스틱 롤업은 챌린지 윈도우가 지나야 강한 확정으로 취급하며 그 전에는 지연을 감안해야 함</li><li>L1이 뒤집히는 아주 이례적인 상황을 제외하면 L1에 최종적으로 기록된 상태는 다시 뒤집히지 않는다는 점을 전제로 시스템을 설계함</li></ul><h2 id=리오그와-헷갈리기-쉬운-것들>리오그와 헷갈리기 쉬운 것들<a hidden class=anchor aria-hidden=true href=#리오그와-헷갈리기-쉬운-것들>#</a></h2><ul><li>RBF나 수수료 경쟁으로 인해 메모풀에서 트랜잭션이 교체되는 현상은 리오그와 별개임</li><li>프로토콜 업그레이드를 위한 하드포크는 합의 규칙 자체를 바꾸는 이벤트이며 자연 발생 리오그와는 범주가 다름</li><li>과거 이더리움 PoW 시절의 옴머 포함은 스테일 블록 보상 메커니즘일 뿐 리오그 자체가 아님</li></ul><h2 id=서비스-설계에-미치는-영향>서비스 설계에 미치는 영향<a hidden class=anchor aria-hidden=true href=#서비스-설계에-미치는-영향>#</a></h2><ul><li><p>결제와 출금</p><ul><li>자산·위험도·체인별로 컨펌 수 정책을 문서화해 운영함</li><li>고가치 결제는 더 많은 컨펌을 요구하고 저가치·소액은 사용자 경험을 위해 낮출 수 있음</li></ul></li><li><p>데이터 처리</p><ul><li>인덱싱은 높이만 저장하지 말고 블록 해시와 부모 해시를 함께 저장</li><li>리오그 감지 시 롤백 가능한 저널을 두고 되감기 후 재처리</li></ul></li><li><p>트랜잭션 처리</p><ul><li>멱등성 확보를 위해 논스·컨트랙트 상태·이벤트 ID를 함께 검증</li><li>재방송은 동일 논스로 수행해 중복 실행을 피함</li></ul></li><li><p>UX</p><ul><li>잠정 상태 표시와 컨펌 카운터 제공</li><li>세이프 헤드와 파이널라이즈드의 차이를 사용자에게 명확히 안내</li></ul></li></ul><h2 id=리오그-감지와-대응-패턴>리오그 감지와 대응 패턴<a hidden class=anchor aria-hidden=true href=#리오그-감지와-대응-패턴>#</a></h2><ul><li><p>헤드 해시 변화 모니터링과 특정 깊이 이상 변화시 경보</p></li><li><p>최신 N개 블록의 체인ID·높이·해시·부모 해시·도착 시각을 원장과 별도 테이블에 윈도우로 관리</p></li><li><p>확정 레벨별로 파이프라인을 분기</p><ul><li>헤드 기준 실시간 기능</li><li>세이프 기준 중요 알림</li><li>파이널 기준 영구 저장</li></ul></li><li><p>간단 의사코드</p></li></ul><pre><code class=language-pseudo>onNewBlock(b):
  save(b.height, b.hash, b.parent)
  if parentNotHead():
    // reorg 발생
    rollbackUntilCommonAncestor()
    replayFromAncestor()
  routePipelinesByCommitment(head, safe, finalized)</code></pre><h2 id=운영-체크리스트>운영 체크리스트<a hidden class=anchor aria-hidden=true href=#운영-체크리스트>#</a></h2><ul><li>컨펌 정책과 리오그 최대 허용 깊도가 문서화되어 있음</li><li>인덱서가 롤백과 재처리를 지원함</li><li>알림 시스템이 헤드 전환과 리오그 이벤트를 기록함</li><li>파이널라이즈드 구간만 영구 저장하거나 백그라운드 확정화 작업을 운영함</li><li>L2의 챌린지 윈도우와 브리지 지연을 고려해 타임라인을 설계함</li></ul><h2 id=간단-시나리오>간단 시나리오<a hidden class=anchor aria-hidden=true href=#간단-시나리오>#</a></h2><p>한국과 미국에서 같은 높이 블록이 동시에 생성됨
각 지역 노드가 자신이 먼저 본 블록 위로 다음 블록을 쌓음
한쪽 체인이 한 블록 더 빨리 쌓이며 우세해지면 다른 쪽은 스테일 처리됨
스테일 체인에 있던 거래는 메모풀로 돌아가 메인 체인에 재포함을 기다림</p><h2 id=참고자료>참고자료<a hidden class=anchor aria-hidden=true href=#참고자료>#</a></h2><ul><li><a href="https://en.bitcoin.it/wiki/Chain_Reorganization?utm_source=chatgpt.com">https://en.bitcoin.it/wiki/Chain_Reorganization?utm_source=chatgpt.com</a></li><li><a href="https://learnmeabitcoin.com/technical/blockchain/chain-reorganization/?utm_source=chatgpt.com">https://learnmeabitcoin.com/technical/blockchain/chain-reorganization/?utm_source=chatgpt.com</a></li><li><a href="https://ethereum.org/en/developers/docs/consensus-mechanisms/pos/?utm_source=chatgpt.com">https://ethereum.org/en/developers/docs/consensus-mechanisms/pos/?utm_source=chatgpt.com</a></li><li><a href="https://ethereum.org/en/developers/docs/scaling/optimistic-rollups/?utm_source=chatgpt.com">https://ethereum.org/en/developers/docs/scaling/optimistic-rollups/?utm_source=chatgpt.com</a></li><li><a href="https://www.alchemy.com/overviews/ethereum-commitment-levels?utm_source=chatgpt.com">https://www.alchemy.com/overviews/ethereum-commitment-levels?utm_source=chatgpt.com</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.jsontapose.com/tags/blockchain/>Blockchain</a></li><li><a href=https://blog.jsontapose.com/tags/reorg/>Reorg</a></li><li><a href=https://blog.jsontapose.com/tags/chain-reorganization/>Chain Reorganization</a></li><li><a href=https://blog.jsontapose.com/tags/consensus/>Consensus</a></li><li><a href=https://blog.jsontapose.com/tags/confirmation/>Confirmation</a></li></ul><nav class=paginav><a class=prev href=https://blog.jsontapose.com/posts/zkp-concepts-and-how-it-works-vs-digital-signatures-1338b0/><span class=title>« Prev</span><br><span>영지식 증명 ZKP의 개념과 동작 원리, 디지털 서명과의 차이</span>
</a><a class=next href=https://blog.jsontapose.com/posts/custodial-vs-noncustodial-wallets-274b74/><span class=title>Next »</span><br><span>커스토디얼 vs 논커스토디얼 월렛 비교</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 블록체인 Reorg(체인 재구성) 이해 on x" href="https://x.com/intent/tweet/?text=%eb%b8%94%eb%a1%9d%ec%b2%b4%ec%9d%b8%20Reorg%28%ec%b2%b4%ec%9d%b8%20%ec%9e%ac%ea%b5%ac%ec%84%b1%29%20%ec%9d%b4%ed%95%b4&amp;url=https%3a%2f%2fblog.jsontapose.com%2fposts%2fblockchain-reorg-chain-reorganization-f4966a%2f&amp;hashtags=blockchain%2creorg%2cchainreorganization%2cconsensus%2cconfirmation"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 블록체인 Reorg(체인 재구성) 이해 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.jsontapose.com%2fposts%2fblockchain-reorg-chain-reorganization-f4966a%2f&amp;title=%eb%b8%94%eb%a1%9d%ec%b2%b4%ec%9d%b8%20Reorg%28%ec%b2%b4%ec%9d%b8%20%ec%9e%ac%ea%b5%ac%ec%84%b1%29%20%ec%9d%b4%ed%95%b4&amp;summary=%eb%b8%94%eb%a1%9d%ec%b2%b4%ec%9d%b8%20Reorg%28%ec%b2%b4%ec%9d%b8%20%ec%9e%ac%ea%b5%ac%ec%84%b1%29%20%ec%9d%b4%ed%95%b4&amp;source=https%3a%2f%2fblog.jsontapose.com%2fposts%2fblockchain-reorg-chain-reorganization-f4966a%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 블록체인 Reorg(체인 재구성) 이해 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.jsontapose.com%2fposts%2fblockchain-reorg-chain-reorganization-f4966a%2f&title=%eb%b8%94%eb%a1%9d%ec%b2%b4%ec%9d%b8%20Reorg%28%ec%b2%b4%ec%9d%b8%20%ec%9e%ac%ea%b5%ac%ec%84%b1%29%20%ec%9d%b4%ed%95%b4"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 블록체인 Reorg(체인 재구성) 이해 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.jsontapose.com%2fposts%2fblockchain-reorg-chain-reorganization-f4966a%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 블록체인 Reorg(체인 재구성) 이해 on whatsapp" href="https://api.whatsapp.com/send?text=%eb%b8%94%eb%a1%9d%ec%b2%b4%ec%9d%b8%20Reorg%28%ec%b2%b4%ec%9d%b8%20%ec%9e%ac%ea%b5%ac%ec%84%b1%29%20%ec%9d%b4%ed%95%b4%20-%20https%3a%2f%2fblog.jsontapose.com%2fposts%2fblockchain-reorg-chain-reorganization-f4966a%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 블록체인 Reorg(체인 재구성) 이해 on telegram" href="https://telegram.me/share/url?text=%eb%b8%94%eb%a1%9d%ec%b2%b4%ec%9d%b8%20Reorg%28%ec%b2%b4%ec%9d%b8%20%ec%9e%ac%ea%b5%ac%ec%84%b1%29%20%ec%9d%b4%ed%95%b4&amp;url=https%3a%2f%2fblog.jsontapose.com%2fposts%2fblockchain-reorg-chain-reorganization-f4966a%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 블록체인 Reorg(체인 재구성) 이해 on ycombinator" href="https://news.ycombinator.com/submitlink?t=%eb%b8%94%eb%a1%9d%ec%b2%b4%ec%9d%b8%20Reorg%28%ec%b2%b4%ec%9d%b8%20%ec%9e%ac%ea%b5%ac%ec%84%b1%29%20%ec%9d%b4%ed%95%b4&u=https%3a%2f%2fblog.jsontapose.com%2fposts%2fblockchain-reorg-chain-reorganization-f4966a%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://blog.jsontapose.com/>HandsLog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>